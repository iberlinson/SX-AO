{
  "workflow": {
    "unique_name": "definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF",
    "name": "Umbrella - Alerting",
    "title": "Umbrella - Alerting",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "tabletype_01EGEGSGVS20N13S1KPEz8fOy2ANAhTiYpj",
        "properties": {
          "scope": "local",
          "name": "Temp_Domain_Table",
          "type": "datatype.table",
          "description": "Temp domain table to store unique domain values",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01MDI7G9FT39N3o2LGJm6OAmZxsGZCCTOqM",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 1200,
          "scope": "local",
          "name": "Delay",
          "type": "datatype.integer",
          "description": "Number of minutes for the last security activity (use to calculate timestamp from past date)",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01MDI7G9FT7R94tcPz5r3Tu0k55Ewz1gSFw",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Incident Title",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01MFQAVD2KA9R6MKrQc2IzDeG1eD1SwHdjZ",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 1,
          "scope": "local",
          "name": "Always True Condition",
          "type": "datatype.integer",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01MDI7G9FT6J817oDYeMdTFeDYTUSwoOWgP",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Incident Description",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_01MFQB0TUGPOD79KuwdzUDJLmhwsueL9ybJ",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": true,
      "description": "Enable near real time notification for Umbrella Security events\n- Notify in Cisco Webex\n- Enrichment CTR + Investigate\n- Create Casebook and Incident in CTR\n- Create Case in The Hive\n- Create Case in ServiceNow\n- Notification update in Cisco Teams\n\nSet Global Variable Umbrella_loop_counter to 500 before to run\nEnable Triggers 5mn for permanent execution",
      "display_name": "Umbrella - Alerting",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "execute_on_target_group": false,
        "execute_on_workflow_target": false,
        "no_target": true,
        "specify_on_workflow_start": false
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01MDI7HLFU8DO6xm4EKUIktSJJaU71X7cJz",
        "name": "Condition Block",
        "title": "Condition Block",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": true,
          "description": "Check the loop counter (global variable). If not 500 it means a workflow is still running so do nothing)",
          "display_name": "Condition Block",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_01MDI7I793KSG2jgfFaQbABleGkqiE0UZin",
            "name": "Condition Branch",
            "title": "Condition Loop Counter = 500",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$global.variable_01LGYFHE8DD8A7767SRhj0daGxv5R67jPTk.global.variable_01LGYFHE8DD8A7767SRhj0daGxv5R67jPTk$",
                "operator": "eq",
                "right_operand": 500
              },
              "continue_on_failure": true,
              "display_name": "Condition Loop Counter = 500",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01MFPJOVB1AE831tbnPcoarrZ8fwd6OUFpI",
                "name": "Group",
                "title": "Variables",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Variables",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01MDI7IWXKS5U6RtE3TpGxfcvAAyKOyaVEt",
                    "name": "Webex Teams - Search for Room",
                    "title": "Webex Teams - Search for Room",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Webex Teams - Search for Room",
                      "input": {
                        "variable_workflow_01FHMU6RWYQWI3QFUEzjWMT7JYBcz5vquuD": "",
                        "variable_workflow_01FHMU6RWYWY822p43LeMi8Lcx89Q9jeyek": "Alerting",
                        "variable_workflow_01FHMU6RWYY481TVWDm0BQ1p0rWnqak191l": "$global.variable_01KEH4RU5N6VM1dCv2HDrsRXCbj0pv64GI8.global.variable_01KEH4RU5N6VM1dCv2HDrsRXCbj0pv64GI8$",
                        "variable_workflow_01FHNGCYY2O6Z0NcPmUDabszT2P4P0oqMNd": ""
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target": true,
                        "target_id": "definition_target_01KJANNE7TR2C6ahGVhbhP3X5JvEtPoSLKV",
                        "target_type": "web-service.endpoint"
                      },
                      "workflow_id": "definition_workflow_01FHMU6SD5XPL6eRW4zFXqkA1w8jWiQCIBU"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01MDI7IJVZL265hMCoPaITKrgyqIHBxmNsB",
                    "name": "Set Variables",
                    "title": "Reset loop counter",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Reset loop counter",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$global.variable_01LGYFHE8DD8A7767SRhj0daGxv5R67jPTk.global.variable_01LGYFHE8DD8A7767SRhj0daGxv5R67jPTk$",
                          "variable_value_new": 0
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01MDI7K3Y7GKV679tvNfqnzAmaWicbB9vs0",
                "name": "While Loop",
                "title": "While Loop (Limit 500)",
                "type": "logic.while",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "description": "Limit to 500 iteration set by SXAO global env variable",
                  "display_name": "While Loop (Limit 500)",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01MDI7KG34OMZ1gPryHPWy3PLxVuvMMGdBb",
                    "name": "Condition Branch",
                    "title": "Condition Always true",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF.local.variable_workflow_01MDI7G9FT6J817oDYeMdTFeDYTUSwoOWgP$",
                        "operator": "eq",
                        "right_operand": 1
                      },
                      "continue_on_failure": false,
                      "display_name": "Condition Always true",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01MDI7KI7FO3A2t5JEoxmVdI5h8jvfkdm9D",
                        "name": "Group",
                        "title": "Calculate Timestamps",
                        "type": "logic.group",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Calculate Timestamps",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01MDI7KUX2IAS1XW7xWIaJht5JHH7vjZLkb",
                            "name": "Execute Python Script",
                            "title": "Timestamp_from_PastDate",
                            "type": "python3.script",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "description": "Now - Delay in minutes (local variable)",
                              "display_name": "Timestamp_from_PastDate",
                              "script": "from datetime import datetime, timedelta\nimport sys\n\nif sys.version_info[0] \u003c 3 or sys.version_info[1] \u003c 4:\n    # python version \u003c 3.3\n    import time\n    def timestamp(date):\n        return time.mktime(date.timetuple())\nelse:\n    def timestamp(date):\n        return date.timestamp()\n\ndelay = int(sys.argv[1])\n\ndate1 = datetime.now() - timedelta(minutes=delay)\nts = timestamp(date1)\nprint(ts)",
                              "script_arguments": [
                                "$workflow.definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF.local.variable_workflow_01MDI7G9FT7R94tcPz5r3Tu0k55Ewz1gSFw$"
                              ],
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01MDI7L6YP7H978SJd6RowsPav9wB6MtNc2",
                            "name": "Execute Python Script",
                            "title": "Timestamp_Now",
                            "type": "python3.script",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": false,
                              "display_name": "Timestamp_Now",
                              "script": "from datetime import datetime\nimport sys\n\nif sys.version_info[0] \u003c 3 or sys.version_info[1] \u003c 4:\n    # python version \u003c 3.3\n    import time\n    def timestamp(date):\n        return time.mktime(date.timetuple())\nelse:\n    def timestamp(date):\n        return date.timestamp()\n\ndate1 = datetime.now()\nts = timestamp(date1)\nprint(ts)",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01MDI7LSHZYWX1Z5mm7IkLoNrPUfc9ZDULo",
                        "name": "Group",
                        "title": "Get Unique last blocked destinations (Security)",
                        "type": "logic.group",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Get Unique last blocked destinations (Security)",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01MDI7M5933OZ2t9btdueZKqQUhkM29SOkg",
                            "name": "HTTP Request",
                            "title": "Umbrella Get Security Events",
                            "type": "web-service.http_request",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "allow_auto_redirect": true,
                              "continue_on_error_status_code": false,
                              "continue_on_failure": true,
                              "display_name": "Umbrella Get Security Events",
                              "method": "GET",
                              "relative_url": "/v1/organizations/$global.variable_01LL3TQGT3RD9584LsDd2gEmZ7qGBN1OoYt.global.variable_01LL3TQGT3RD9584LsDd2gEmZ7qGBN1OoYt$/security-activity?limit=500\u0026start=$activity.definition_activity_01MDI7KUX2IAS1XW7xWIaJht5JHH7vjZLkb.output.response_body$\u0026end=$activity.definition_activity_01MDI7L6YP7H978SJd6RowsPav9wB6MtNc2.output.response_body$",
                              "runtime_user": {
                                "override_target_runtime_user": false,
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "override_workflow_target": true,
                                "target_id": "definition_target_01JLRTQCEHBA93OQhYXQCrV9TYW4Lmy1oS3"
                              }
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01MDI7N3DAR1I6hBwX2NDU77LwPvbZI3Yxi",
                            "name": "Read Table from JSON",
                            "title": "Read Table from JSON",
                            "type": "corejava.read_table_from_json",
                            "base_type": "activity",
                            "properties": {
                              "action_timeout": 180,
                              "continue_on_failure": true,
                              "display_name": "Read Table from JSON",
                              "input_json": "$activity.definition_activity_01MDI7M5933OZ2t9btdueZKqQUhkM29SOkg.output.response_body$",
                              "jsonpath_query": "$.requests.[*]",
                              "persist_output": true,
                              "populate_columns": false,
                              "skip_execution": false,
                              "table_columns": [
                                {
                                  "column_name": "destination",
                                  "column_type": "string"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01MDI7NHHR7765fiWq3Z1GpbVFBkHKLW8eN",
                            "name": "Condition Block",
                            "title": "Remove duplicate",
                            "type": "logic.if_else",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Remove duplicate",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "blocks": [
                              {
                                "unique_name": "definition_activity_01MDI7O3MGS6N1Tfbrd6d5JrKCiEcYYjrte",
                                "name": "Condition Branch",
                                "title": "Condition  only 1 event",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01MDI7N3DAR1I6hBwX2NDU77LwPvbZI3Yxi.output.row_count$",
                                    "operator": "lte",
                                    "right_operand": 1
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Condition  only 1 event",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01MDI7OG7DOKQ09OO11o5lFsLbNid4vnUUG",
                                    "name": "Replace String",
                                    "title": "Remove http:// https://",
                                    "type": "core.replacestring",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": true,
                                      "display_name": "Remove http:// https://",
                                      "input_string": "$activity.definition_activity_01MDI7N3DAR1I6hBwX2NDU77LwPvbZI3Yxi.output.read_table_from_json[0].destination$",
                                      "replace_list": [
                                        {
                                          "replaced_string": "http://",
                                          "replacement_string": ""
                                        },
                                        {
                                          "replaced_string": "https://",
                                          "replacement_string": ""
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01MDI7OSUTHCP3ZX1lBfXmhka7ssZzWrG9e",
                                    "name": "Match Regex",
                                    "title": "Get domain only",
                                    "type": "core.matchregex",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Get domain only",
                                      "input_regex": "([a-zA-Z0-9\\.\\-]+)",
                                      "input_string": "$activity.definition_activity_01MDI7OG7DOKQ09OO11o5lFsLbNid4vnUUG.output.result_string$",
                                      "match_case": true,
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01MDI7PFKGZ440r5gXuMlCGEUi1baW1g2iV",
                                    "name": "Add Row to Table",
                                    "title": "Add Row to Temp Domain Table",
                                    "type": "core.addrowtotable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": false,
                                      "display_name": "Add Row to Temp Domain Table",
                                      "input_table": "$workflow.definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF.local.variable_workflow_01MDI7G9FT39N3o2LGJm6OAmZxsGZCCTOqM$",
                                      "row": [
                                        {
                                          "key": "distinctvalue",
                                          "type": "string",
                                          "value": "$activity.definition_activity_01MDI7OSUTHCP3ZX1lBfXmhka7ssZzWrG9e.output.matching_strings[0]$"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01MDI7PSMDB214RprEhHILNA6WGQXOQcBzI",
                                "name": "Condition Branch",
                                "title": "Condition more than 1 event",
                                "type": "logic.condition_block",
                                "base_type": "activity",
                                "properties": {
                                  "condition": {
                                    "left_operand": "$activity.definition_activity_01MDI7N3DAR1I6hBwX2NDU77LwPvbZI3Yxi.output.row_count$",
                                    "operator": "gt",
                                    "right_operand": 1
                                  },
                                  "continue_on_failure": false,
                                  "display_name": "Condition more than 1 event",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01MDI7PV7OPMO3MtOwhGPwSeIXb4G36yT6i",
                                    "name": "JSONPath Query",
                                    "title": "Get all destination values",
                                    "type": "corejava.jsonpathquery",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": false,
                                      "display_name": "Get all destination values",
                                      "input_json": "$activity.definition_activity_01MDI7N3DAR1I6hBwX2NDU77LwPvbZI3Yxi.output.response_body$",
                                      "jsonpath_queries": [
                                        {
                                          "jsonpath_query": "$.[*].destination",
                                          "jsonpath_query_name": "destination",
                                          "jsonpath_query_type": "string"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01MDI7Q83DACD1nOn0e89ebGXW1rEsH4VLp",
                                    "name": "Replace String",
                                    "title": "Remove http:// https://",
                                    "type": "core.replacestring",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": true,
                                      "display_name": "Remove http:// https://",
                                      "input_string": "$activity.definition_activity_01MDI7PV7OPMO3MtOwhGPwSeIXb4G36yT6i.output.jsonpath_queries.destination$",
                                      "replace_list": [
                                        {
                                          "replaced_string": "http://",
                                          "replacement_string": ""
                                        },
                                        {
                                          "replaced_string": "https://",
                                          "replacement_string": ""
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01MDI7QKRL2814ORCMP4MyncRtQFFek16fM",
                                    "name": "Execute Python Script",
                                    "title": "Get list of unique values",
                                    "type": "python3.script",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": false,
                                      "display_name": "Get list of unique values",
                                      "script": "import json, sys\nlist1  = json.loads(sys.argv[1])\nlist_set = set(list1)\nunique = []\nunique_list = (list(list_set))\nfor x in unique_list:\n    unique.append(x)",
                                      "script_arguments": [
                                        "$activity.definition_activity_01MDI7Q83DACD1nOn0e89ebGXW1rEsH4VLp.output.result_string$"
                                      ],
                                      "script_queries": [
                                        {
                                          "script_query": "unique",
                                          "script_query_name": "unique",
                                          "script_query_type": "string"
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01MDI7QXBFD5O1E5z5kchpgWEE48ABsuili",
                                    "name": "Replace String",
                                    "title": "Remove special caracters",
                                    "type": "core.replacestring",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Remove special caracters",
                                      "input_string": "$activity.definition_activity_01MDI7QKRL2814ORCMP4MyncRtQFFek16fM.output.script_queries.unique$",
                                      "replace_list": [
                                        {
                                          "replaced_string": "[",
                                          "replacement_string": ""
                                        },
                                        {
                                          "replaced_string": "]",
                                          "replacement_string": ""
                                        },
                                        {
                                          "replaced_string": "'",
                                          "replacement_string": ""
                                        }
                                      ],
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01MDI7R9VK9RV6aFQchHlZM0LARzC871BPn",
                                    "name": "Split String",
                                    "title": "Split list",
                                    "type": "core.splitstring",
                                    "base_type": "activity",
                                    "properties": {
                                      "boundaries": [
                                        {
                                          "boundary": ","
                                        }
                                      ],
                                      "continue_on_failure": false,
                                      "display_name": "Split list",
                                      "input_string": "$activity.definition_activity_01MDI7QXBFD5O1E5z5kchpgWEE48ABsuili.output.result_string$",
                                      "remove_empty": true,
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  },
                                  {
                                    "unique_name": "definition_activity_01MDI7RMP1HR80FkPsFotxIIsaG7N2z4zLO",
                                    "name": "For Each",
                                    "title": "For Each",
                                    "type": "logic.for_each",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "For Each",
                                      "skip_execution": false,
                                      "source_array": "$activity.definition_activity_01MDI7R9VK9RV6aFQchHlZM0LARzC871BPn.output.parts$"
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01MDI7S0GBCMQ3eolivIDsbQ2pjFDjrFkZr",
                                        "name": "Match Regex",
                                        "title": "Get domain only",
                                        "type": "core.matchregex",
                                        "base_type": "activity",
                                        "properties": {
                                          "continue_on_failure": false,
                                          "display_name": "Get domain only",
                                          "input_regex": "([a-zA-Z0-9\\.\\-]+)",
                                          "input_string": "$activity.definition_activity_01MDI7RMP1HR80FkPsFotxIIsaG7N2z4zLO.input.source_array[@]$",
                                          "match_case": true,
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01MDI7SDF46673wKgyd3G0VPz36bVbWRtDj",
                                        "name": "Add Row to Table",
                                        "title": "Add Row to Temp Domain Table",
                                        "type": "core.addrowtotable",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "continue_on_failure": false,
                                          "display_name": "Add Row to Temp Domain Table",
                                          "input_table": "$workflow.definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF.local.variable_workflow_01MDI7G9FT39N3o2LGJm6OAmZxsGZCCTOqM$",
                                          "row": [
                                            {
                                              "key": "distinctvalue",
                                              "type": "string",
                                              "value": "$activity.definition_activity_01MDI7S0GBCMQ3eolivIDsbQ2pjFDjrFkZr.output.matching_strings[0]$"
                                            }
                                          ],
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01MDI7T1D9ISB3o8o4npKBxv1WiRALKsGc8",
                        "name": "Condition Block",
                        "title": "Condition Block",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Condition Block",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01MDI7TNFYW7K6WCA4yErrwRQZweEUEkRLf",
                            "name": "Condition Branch",
                            "title": "If domain(s) bocked",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01MDI7N3DAR1I6hBwX2NDU77LwPvbZI3Yxi.output.succeeded$",
                                "operator": "eq",
                                "right_operand": true
                              },
                              "continue_on_failure": false,
                              "display_name": "If domain(s) bocked",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01MFOXHH6KR900SRR0R5vUCg57MqvIH4Dg8",
                                "name": "Group",
                                "title": "Variables",
                                "type": "logic.group",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "description": "CTRToken - room Id - Domains for iteration",
                                  "display_name": "Variables",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01MDI7UWESUQ36ovk9vOLoO7bXPAfuQsPHM",
                                    "name": "Select from Table",
                                    "title": "Select Unique domain from Table",
                                    "type": "core.selectfromtable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "columns": [
                                        {
                                          "column_name": "distinctvalue",
                                          "column_type": "string"
                                        }
                                      ],
                                      "continue_on_failure": true,
                                      "display_name": "Select Unique domain from Table",
                                      "input_table": "$workflow.definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF.local.variable_workflow_01MDI7G9FT39N3o2LGJm6OAmZxsGZCCTOqM$",
                                      "number_of_rows": {
                                        "all_rows": true,
                                        "at_most": false
                                      },
                                      "persist_output": false,
                                      "skip_execution": false,
                                      "sorting": {
                                        "no_sort": true,
                                        "sort_by": false
                                      }
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC",
                                "name": "For Each",
                                "title": "For Each domain blocked",
                                "type": "logic.for_each",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": true,
                                  "display_name": "For Each domain blocked",
                                  "skip_execution": false,
                                  "source_array": "$activity.definition_activity_01MDI7UWESUQ36ovk9vOLoO7bXPAfuQsPHM.output.output_table$"
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01MDI7WGH62AA2rMygQ9HUAmc6OlRKETHwB",
                                    "name": "Group",
                                    "title": "Check if alert already sent for this domain",
                                    "type": "logic.group",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": false,
                                      "display_name": "Check if alert already sent for this domain",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "actions": [
                                      {
                                        "unique_name": "definition_activity_01MGJBEJ4GCR80OWOmbssacbcackoVkUjzS",
                                        "name": "Select from Table",
                                        "title": "Select from Table",
                                        "type": "core.selectfromtable",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "columns": [
                                            {
                                              "column_name": "distinctvalue",
                                              "column_type": "string"
                                            }
                                          ],
                                          "continue_on_failure": false,
                                          "display_name": "Select from Table",
                                          "input_table": "$global.variable_01MGJAP9XYQ682iEgn3j9lPz7JaWeisRUXY.global.variable_01MGJAP9XYQ682iEgn3j9lPz7JaWeisRUXY$",
                                          "number_of_rows": {
                                            "all_rows": true,
                                            "at_most": false
                                          },
                                          "persist_output": false,
                                          "skip_execution": false,
                                          "sorting": {
                                            "no_sort": true,
                                            "sort_by": false
                                          },
                                          "where_clause": "distinctvalue LIKE '$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$'"
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01MDI7X2UF5Z20FnVkXUSwHsqOtIP7OoxQ7",
                                        "name": "HTTP Request",
                                        "title": "Query Private Intel",
                                        "type": "web-service.http_request",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "allow_auto_redirect": true,
                                          "continue_on_error_status_code": false,
                                          "continue_on_failure": true,
                                          "custom_headers": [
                                            {
                                              "name": "Authorization",
                                              "value": "Bearer $activity.01MDI7UA068EV19pFI1OpdyFossWau0r5TO.output.01M883J4VO2VJ5uOVdycp4hd3MejIFksIf7$"
                                            }
                                          ],
                                          "display_name": "Query Private Intel",
                                          "method": "GET",
                                          "relative_url": "/ctia/judgement/search?fields=id\u0026fields=reason\u0026fields=observable.value\u0026query='$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$'",
                                          "runtime_user": {
                                            "override_target_runtime_user": false,
                                            "target_default": true
                                          },
                                          "skip_execution": true,
                                          "target": {
                                            "override_workflow_target": true,
                                            "target_id": "definition_target_01M8823MMO4QO73ETHXSQUfobrgRuuHHERk"
                                          }
                                        },
                                        "object_type": "definition_activity"
                                      },
                                      {
                                        "unique_name": "definition_activity_01MDI7XGFJRHC3GOGpk7eGWtuPgPaEAU0LE",
                                        "name": "Read Table from JSON",
                                        "title": "Read Table from JSON",
                                        "type": "corejava.read_table_from_json",
                                        "base_type": "activity",
                                        "properties": {
                                          "action_timeout": 180,
                                          "continue_on_failure": true,
                                          "display_name": "Read Table from JSON",
                                          "input_json": "$activity.definition_activity_01MDI7X2UF5Z20FnVkXUSwHsqOtIP7OoxQ7.output.response_body$",
                                          "jsonpath_query": "$.[*]",
                                          "persist_output": true,
                                          "populate_columns": false,
                                          "skip_execution": true,
                                          "table_columns": [
                                            {
                                              "column_name": "reason",
                                              "column_type": "string"
                                            },
                                            {
                                              "column_name": "id",
                                              "column_type": "string"
                                            },
                                            {
                                              "column_name": "observable",
                                              "column_type": "string"
                                            }
                                          ]
                                        },
                                        "object_type": "definition_activity"
                                      }
                                    ]
                                  },
                                  {
                                    "unique_name": "definition_activity_01MDI7XU7S7DX2swZV3K1g0TlcLimQrowtg",
                                    "name": "Condition Block",
                                    "title": "Condition Block",
                                    "type": "logic.if_else",
                                    "base_type": "activity",
                                    "properties": {
                                      "continue_on_failure": true,
                                      "display_name": "Condition Block",
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity",
                                    "blocks": [
                                      {
                                        "unique_name": "definition_activity_01MDI7Y6L6LBZ55su5lLlq2YZdO8dTSw4AF",
                                        "name": "Condition Branch",
                                        "title": "If new domain Blocked then",
                                        "type": "logic.condition_block",
                                        "base_type": "activity",
                                        "properties": {
                                          "condition": {
                                            "left_operand": "$activity.definition_activity_01MGJBEJ4GCR80OWOmbssacbcackoVkUjzS.output.row_count$",
                                            "operator": "lt",
                                            "right_operand": 1
                                          },
                                          "continue_on_failure": true,
                                          "display_name": "If new domain Blocked then",
                                          "skip_execution": false
                                        },
                                        "object_type": "definition_activity",
                                        "actions": [
                                          {
                                            "unique_name": "definition_activity_01MFOW78QMDNU0wqSgjPpEOge8LZcpdRii4",
                                            "name": "Group",
                                            "title": "Notify",
                                            "type": "logic.group",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Notify",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01MFPAHKCZVHY4NrWXXprNRU6h2ps2WA0o9",
                                                "name": "Parallel Block",
                                                "title": "Parallel Block - Notify",
                                                "type": "logic.parallel",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Parallel Block - Notify",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "blocks": [
                                                  {
                                                    "unique_name": "definition_activity_01MFPAI5YDA904pm2DXmCFjjufbZE38jXeE",
                                                    "name": "Parallel Branch",
                                                    "title": "Parallel Branch Cisco Webex",
                                                    "type": "logic.parallel_block",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Parallel Branch Cisco Webex",
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity",
                                                    "actions": [
                                                      {
                                                        "unique_name": "definition_activity_01MDI7YQXLLNS2ez7hnTJ3410CXZrQmTn8r",
                                                        "name": "Replace String",
                                                        "title": "Make domain not clickable",
                                                        "type": "core.replacestring",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "continue_on_failure": true,
                                                          "display_name": "Make domain not clickable",
                                                          "input_string": "$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$",
                                                          "replace_list": [
                                                            {
                                                              "replaced_string": ".",
                                                              "replacement_string": "[.]"
                                                            }
                                                          ],
                                                          "skip_execution": false
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MEV6S86QTYU2Sv4A8N7nAFMfajP82kaCQ",
                                                        "name": "HTTP Request",
                                                        "title": "Post Adaptive card to webex",
                                                        "type": "web-service.http_request",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "action_timeout": 180,
                                                          "allow_auto_redirect": true,
                                                          "body": "{\n  \"roomId\": \"$activity.definition_activity_01MDI7IWXKS5U6RtE3TpGxfcvAAyKOyaVEt.output.variable_workflow_01FHSVE2R6ZTQ6L92WEi0kWgR5T8zhMAUzO$\",\n  \"markdown\": \"Details about Domain $activity.definition_activity_01MDI7YQXLLNS2ez7hnTJ3410CXZrQmTn8r.output.result_string$\",\n  \"attachments\": [\n{\n    \"contentType\": \"application/vnd.microsoft.card.adaptive\",\n      \"content\": {\n        \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\n        \"type\": \"AdaptiveCard\",\n        \"version\": \"1.0\",\n    \"body\": [\n        {\n            \"type\": \"ColumnSet\",\n            \"columns\": [\n                {\n                    \"type\": \"Column\",\n                    \"items\": [\n                        {\n                            \"type\": \"Image\",\n                            \"style\": \"Person\",\n                            \"url\": \"https://www.ingramflyhigher.com/campaigns/cisco-umbrella/images/umbrella-small.png\",\n                            \"size\": \"Medium\",\n                            \"height\": \"50px\"\n                        }\n                    ],\n                    \"width\": \"auto\"\n                },\n                {\n                    \"type\": \"Column\",\n                    \"items\": [\n                        {\n                            \"type\": \"TextBlock\",\n                            \"text\": \"Umbrella - SecureX Notification\",\n                            \"weight\": \"Lighter\",\n                            \"color\": \"Accent\"\n                        },\n                        {\n                            \"type\": \"TextBlock\",\n                            \"weight\": \"Bolder\",\n                            \"text\": \"Domain Blocked - Security\",\n                            \"horizontalAlignment\": \"Left\",\n                            \"wrap\": true,\n                            \"color\": \"Light\",\n                            \"size\": \"Large\",\n                            \"spacing\": \"Small\"\n                        }\n                    ],\n                    \"width\": \"stretch\"\n                }\n            ]\n        },\n        {\n            \"type\": \"ColumnSet\",\n            \"columns\": [\n                {\n                    \"type\": \"Column\",\n                    \"width\": 35,\n                    \"items\": [\n                        {\n                            \"type\": \"TextBlock\",\n                            \"text\": \"Domain :\",\n                            \"color\": \"Light\"\n                        }\n                    ]\n                },\n                {\n                    \"type\": \"Column\",\n                    \"width\": 65,\n                    \"items\": [\n                        {\n                            \"type\": \"TextBlock\",\n                            \"weight\": \"Bolder\",\n                            \"text\": \"$activity.definition_activity_01MDI7YQXLLNS2ez7hnTJ3410CXZrQmTn8r.output.result_string$\",\n                            \"color\": \"Light\"\n                        }\n                    ]\n                }\n            ],\n            \"spacing\": \"Padding\",\n            \"horizontalAlignment\": \"Center\"\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"A connection from an endpoint or network has been blocked by Cisco Umbrella for security reasons. More detailled will follow and an incident will be created\",\n            \"wrap\": true\n        },\n        {\n            \"type\": \"ColumnSet\",\n            \"columns\": [\n                {\n                    \"type\": \"Column\",\n                    \"width\": \"auto\",\n                    \"items\": [\n                        {\n                            \"type\": \"Image\",\n                            \"altText\": \"\",\n                            \"url\": \"https://www.cisco.com/c/fr_fr/products/security/threat-response/jcr:content/Grid/category_atl_acfd_co/layout-category-atl/blade_8f01/bladeContents1/tile_3b43.img.png/1608624146425.png\",\n                            \"size\": \"Small\",\n                            \"width\": \"30px\",\n                            \"selectAction\": {\n                                \"type\": \"Action.OpenUrl\",\n                                \"url\": \"https://visibility.amp.cisco.com/investigate?q=domain:'$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$'\"\n                            }\n                        }\n                    ],\n                    \"spacing\": \"Small\"\n                },\n                {\n                    \"type\": \"Column\",\n                    \"width\": \"auto\",\n                    \"items\": [\n                        {\n                            \"type\": \"TextBlock\",\n                            \"text\": \"[Investigate now in SecureX Threat Response]()\",\n                            \"horizontalAlignment\": \"Left\",\n                            \"size\": \"Medium\"\n                        }\n                    ],\n                    \"verticalContentAlignment\": \"Center\",\n                    \"horizontalAlignment\": \"Left\",\n                    \"spacing\": \"Small\"\n                }\n            ]\n        }\n    ]\n  }\n    }\n  ]\n}",
                                                          "content_type": "application/json",
                                                          "continue_on_error_status_code": false,
                                                          "continue_on_failure": false,
                                                          "custom_headers": [
                                                            {
                                                              "name": "Authorization",
                                                              "value": "Bearer $global.variable_01KEH4RU5N6VM1dCv2HDrsRXCbj0pv64GI8.global.variable_01KEH4RU5N6VM1dCv2HDrsRXCbj0pv64GI8$"
                                                            }
                                                          ],
                                                          "display_name": "Post Adaptive card to webex",
                                                          "method": "POST",
                                                          "relative_url": "/v1/messages",
                                                          "runtime_user": {
                                                            "override_target_runtime_user": false,
                                                            "target_default": true
                                                          },
                                                          "skip_execution": false,
                                                          "target": {
                                                            "override_workflow_target": true,
                                                            "target_id": "definition_target_01KJANNE7TR2C6ahGVhbhP3X5JvEtPoSLKV"
                                                          }
                                                        },
                                                        "object_type": "definition_activity"
                                                      }
                                                    ]
                                                  },
                                                  {
                                                    "unique_name": "definition_activity_01MFPAI6MCZ084v4mecQjnKko0mv4UnbeX0",
                                                    "name": "Parallel Branch",
                                                    "title": "Parallel Branch Microsoft Teams",
                                                    "type": "logic.parallel_block",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Parallel Branch Microsoft Teams",
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "unique_name": "definition_activity_01MFP9TZJOVAX7Py5SypmsLiHGAiyAh6Xjl",
                                            "name": "Group",
                                            "title": "Admin Tasks",
                                            "type": "logic.group",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Admin Tasks",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01MDI7UAICV7P6NdagEpDYNUhK64uRb5LAV",
                                                "name": "CTR Generate Access Token",
                                                "title": "CTR Generate Access Token",
                                                "type": "workflow.atomic_workflow",
                                                "base_type": "subworkflow",
                                                "properties": {
                                                  "continue_on_failure": true,
                                                  "display_name": "CTR Generate Access Token",
                                                  "runtime_user": {
                                                    "target_default": true
                                                  },
                                                  "skip_execution": false,
                                                  "target": {
                                                    "override_workflow_target": true,
                                                    "target_id": "definition_target_01M8822QE1ASK0LBDYTzl3OKw4v2xiLFH4l",
                                                    "target_type": "web-service.endpoint"
                                                  },
                                                  "workflow_id": "definition_workflow_01779LB6MV0P02kvka9TGV5cEam84NrCTy4"
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01MGJD4MVWCTE1nN4IVhgmE1Q5M0cFH6FQH",
                                                "name": "Add Row to Table",
                                                "title": "Add Row to Table",
                                                "type": "core.addrowtotable",
                                                "base_type": "activity",
                                                "properties": {
                                                  "action_timeout": 180,
                                                  "continue_on_failure": false,
                                                  "display_name": "Add Row to Table",
                                                  "input_table": "$global.variable_01MGJAP9XYQ682iEgn3j9lPz7JaWeisRUXY.global.variable_01MGJAP9XYQ682iEgn3j9lPz7JaWeisRUXY$",
                                                  "row": [
                                                    {
                                                      "key": "distinctvalue",
                                                      "type": "string",
                                                      "value": "$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$"
                                                    }
                                                  ],
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01MDI7Y9O6BLY1EOeS5omCXvtKW7QJCEfOk",
                                                "name": "HTTP Request",
                                                "title": "Add domain to Private Intel (Judgement)",
                                                "type": "web-service.http_request",
                                                "base_type": "activity",
                                                "properties": {
                                                  "action_timeout": 180,
                                                  "allow_auto_redirect": true,
                                                  "body": "{\n  \"valid_time\": {\n    \"start_time\": \"2020-10-28T11:47:25.622Z\",\n    \"end_time\": \"2020-10-28T11:47:25.622Z\"\n  },\n  \"observable\": {\n    \"value\": \"$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$\",\n    \"type\": \"domain\"\n  },\n  \"type\": \"judgement\",\n  \"source\": \"SecureX AO\",\n  \"disposition\": 2,\n  \"reason\": \"AO\",\n  \"disposition_name\": \"Malicious\",\n  \"priority\": 0,\n  \"severity\": \"Medium\",\n  \"tlp\": \"white\",\n  \"timestamp\": \"2020-10-28T11:47:25.622Z\",\n  \"confidence\": \"Medium\"\n}",
                                                  "content_type": "application/json",
                                                  "continue_on_error_status_code": false,
                                                  "continue_on_failure": true,
                                                  "custom_headers": [
                                                    {
                                                      "name": "Authorization",
                                                      "value": "Bearer $activity.definition_activity_01MDI7UAICV7P6NdagEpDYNUhK64uRb5LAV.output.variable_workflow_01BNOOXA3G6MV1PGAvsfZOKDdMYcE6XS726$"
                                                    }
                                                  ],
                                                  "display_name": "Add domain to Private Intel (Judgement)",
                                                  "method": "POST",
                                                  "relative_url": "/ctia/judgement?wait_for=false",
                                                  "runtime_user": {
                                                    "override_target_runtime_user": false,
                                                    "target_default": true
                                                  },
                                                  "skip_execution": true,
                                                  "target": {
                                                    "override_workflow_target": true,
                                                    "target_id": "definition_target_01M8823MMO4QO73ETHXSQUfobrgRuuHHERk"
                                                  }
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          },
                                          {
                                            "unique_name": "definition_activity_01MFPG54YQ1LG7bf8jvTd60YqrT5PtI6Amk",
                                            "name": "Parallel Block",
                                            "title": "Parallel Block - enrich",
                                            "type": "logic.parallel",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Parallel Block - enrich",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "blocks": [
                                              {
                                                "unique_name": "definition_activity_01MFPG5RGF3D33dk7TR6WoZ87z305Zl3qih",
                                                "name": "Parallel Branch",
                                                "title": "Parallel Branch SecureX Threat Response",
                                                "type": "logic.parallel_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Parallel Branch SecureX Threat Response",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01MFP1ED84HYP4oiNjcpaYDtxhAF1nbSBMo",
                                                    "name": "Group",
                                                    "title": "SecureX Threat Response",
                                                    "type": "logic.group",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "SecureX Threat Response",
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity",
                                                    "actions": [
                                                      {
                                                        "unique_name": "definition_activity_01MDI8IX184U96ya2uxUfCJRdVwNAkfFHL4",
                                                        "name": "Threat Response v2 - Enrich Observable",
                                                        "title": "Threat Response v2 - Enrich Observable",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Threat Response v2 - Enrich Observable",
                                                          "input": {
                                                            "variable_workflow_01LFCW7BK9JWU2I0o0vdWjBcKeGI9cTXwLT": "domain",
                                                            "variable_workflow_01LFCW7BK9RRM61vI2vN9AXklLnXrOFOSdu": "$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$",
                                                            "variable_workflow_01LFCW7BK9SW92Ai5bUZzG2IKUi6lVxRR2Z": "$activity.definition_activity_01MDI7UAICV7P6NdagEpDYNUhK64uRb5LAV.output.variable_workflow_01BNOOXA3G6MV1PGAvsfZOKDdMYcE6XS726$"
                                                          },
                                                          "runtime_user": {
                                                            "target_default": true
                                                          },
                                                          "skip_execution": false,
                                                          "target": {
                                                            "override_workflow_target": true,
                                                            "target_id": "definition_target_01M8822GXMSX91tiv83gbLmYF1TBH65ZP8l",
                                                            "target_type": "web-service.endpoint"
                                                          },
                                                          "workflow_id": "definition_workflow_01LFCW7C2Q1BU6Szjo7JqBWHWPmevmW7uIn"
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MF7W5TQ0QVR6ke4t5DopfEUTkMIIlNnNd",
                                                        "name": "GET CTR Targets Table",
                                                        "title": "GET CTR Targets Table",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "GET CTR Targets Table",
                                                          "input": {
                                                            "variable_workflow_01JQVN9S6HT9R0GfzNaXucHZlKLjI92yMdD": "$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$",
                                                            "variable_workflow_01JQVROPRFMMC2eDT0cGRe9A8HW03GZ1XZg": "$activity.definition_activity_01MDI8IX184U96ya2uxUfCJRdVwNAkfFHL4.output.variable_workflow_01LFCW7BK9PHR4US5QvFoxwf05w5gnBzrNU$"
                                                          },
                                                          "runtime_user": {
                                                            "target_default": true
                                                          },
                                                          "skip_execution": false,
                                                          "target": {
                                                            "no_target": true
                                                          },
                                                          "workflow_id": "definition_workflow_01JQVN9SHDS7U0aI6ARfYbDceWnEXWS9ExB"
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MFTVAWYQBZ97ZLIPk1K597vyDyV0yFuv1",
                                                        "name": "Select from Table",
                                                        "title": "Select from Table",
                                                        "type": "core.selectfromtable",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "action_timeout": 180,
                                                          "columns": [
                                                            {
                                                              "column_name": "Target",
                                                              "column_type": "string"
                                                            },
                                                            {
                                                              "column_name": "Value",
                                                              "column_type": "string"
                                                            },
                                                            {
                                                              "column_name": "Details",
                                                              "column_type": "string"
                                                            }
                                                          ],
                                                          "continue_on_failure": false,
                                                          "display_name": "Select from Table",
                                                          "input_table": "$activity.definition_activity_01MF7W5TQ0QVR6ke4t5DopfEUTkMIIlNnNd.output.variable_workflow_01JQVN9S6HOME07a9WEGbweBoz7lILpZqD7$",
                                                          "number_of_rows": {
                                                            "all_rows": true,
                                                            "at_most": false
                                                          },
                                                          "persist_output": false,
                                                          "skip_execution": false,
                                                          "sorting": {
                                                            "no_sort": true,
                                                            "sort_by": false
                                                          },
                                                          "where_clause": "Details LIKE 'odns_identity_label' OR Details LIKE 'hostname'"
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MFTSV8LXMI70GbA7zeoEVgtAZVW11tP3N",
                                                        "name": "Get Unique Table Values",
                                                        "title": "Get Unique Table Values",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Get Unique Table Values",
                                                          "input": {
                                                            "variable_workflow_01MD80H8IOAT645oIaeVqFjFMSorHd8NNlF": true,
                                                            "variable_workflow_01MD80H8IODQE7BfMDLWJY2iakmLcHqxYKq": "Target",
                                                            "variable_workflow_01MD80H8IOG2K1mdGIaPmoy1mHQBDvlwscy": "$activity.definition_activity_01MFTVAWYQBZ97ZLIPk1K597vyDyV0yFuv1.output.response_body$"
                                                          },
                                                          "runtime_user": {
                                                            "target_default": true
                                                          },
                                                          "skip_execution": false,
                                                          "target": {
                                                            "no_target": true
                                                          },
                                                          "workflow_id": "definition_workflow_01MD80H8PYWKP3F28UqWl0nlZ02R0hFCsrX"
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MESRXTVLL553SsapE1XVYiRVRsaVYJUvQ",
                                                        "name": "Get CTR Indicators Table ",
                                                        "title": "Get CTR Indicators Table ",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Get CTR Indicators Table ",
                                                          "input": {
                                                            "variable_workflow_01JSC422MTB5F1bxabyeD5XuWKOS7OHNzEw": "$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$",
                                                            "variable_workflow_01JSC422MTF497bbmkgkbjS6VF9nMBIpZmO": "domain",
                                                            "variable_workflow_01JSC422MTG9J1GgZgS9KAJJyxAwkCYOHHT": "$activity.definition_activity_01MDI8IX184U96ya2uxUfCJRdVwNAkfFHL4.output.variable_workflow_01LFCW7BK9PHR4US5QvFoxwf05w5gnBzrNU$"
                                                          },
                                                          "runtime_user": {
                                                            "target_default": true
                                                          },
                                                          "skip_execution": true,
                                                          "target": {
                                                            "no_target": true
                                                          },
                                                          "workflow_id": "definition_workflow_01JSC422Z7Y6P7j77mRKAODnr3h9IdWAMUg"
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MFMAJPFOCNQ3dKXMTLz8DSocMluTN9ILg",
                                                        "name": "Get CTR Judgement",
                                                        "title": "Get CTR Judgement",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Get CTR Judgement",
                                                          "input": {
                                                            "variable_workflow_01JQV4CN4V9ES77MFOkZah7Dv8FPdyjh3zW": "$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$",
                                                            "variable_workflow_01JQV4CN4VFYG6Pr23MVyp1VbpElFxtuBUJ": "domain",
                                                            "variable_workflow_01JQVC42UHVV33KiV76Io4lTgAV1T8wyHfr": "$activity.definition_activity_01MDI8IX184U96ya2uxUfCJRdVwNAkfFHL4.output.variable_workflow_01LFCW7BK9PHR4US5QvFoxwf05w5gnBzrNU$"
                                                          },
                                                          "runtime_user": {
                                                            "target_default": true
                                                          },
                                                          "skip_execution": false,
                                                          "target": {
                                                            "no_target": true
                                                          },
                                                          "workflow_id": "definition_workflow_01JQV4CNFF20759mppNEVKw4P4bSRKDXhuC"
                                                        },
                                                        "object_type": "definition_activity"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "unique_name": "definition_activity_01MFPG5S69OMV7NOV8oZ6q8X3FRHNnHWROd",
                                                "name": "Parallel Branch",
                                                "title": "Parallel Branch Umbrella",
                                                "type": "logic.parallel_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Parallel Branch Umbrella",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01MFP2CUHLRBA2Srronfv5KDj0GKKn8Dos4",
                                                    "name": "Group",
                                                    "title": "Cisco Umbrella",
                                                    "type": "logic.group",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Cisco Umbrella",
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity",
                                                    "actions": [
                                                      {
                                                        "unique_name": "definition_activity_01MET5GY524G42hCvcXvcVTu4dGdxxMj7ds",
                                                        "name": "Umbrella - Investigate - Categorize Single Domain",
                                                        "title": "Umbrella - Investigate - Categorize Single Domain",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Umbrella - Investigate - Categorize Single Domain",
                                                          "input": {
                                                            "variable_workflow_01G5O1SJSIRV61zZs5s3wKG548soQ4obTpU": "$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$",
                                                            "variable_workflow_01J3TWVRNF19I7ljPN95AHAtNt9v945FoYV": "$global.variable_01MET7PX13X2762mqJPLYBVQCFn31jFhjkk.global.variable_01MET7PX13X2762mqJPLYBVQCFn31jFhjkk$"
                                                          },
                                                          "runtime_user": {
                                                            "target_default": true
                                                          },
                                                          "skip_execution": false,
                                                          "target": {
                                                            "override_workflow_target": true,
                                                            "target_id": "definition_target_01MET9C3C0W320lrxwOCzcG7Yw1Rg3zMBSj",
                                                            "target_type": "web-service.endpoint"
                                                          },
                                                          "workflow_id": "definition_workflow_01G5O02N3T9NE0uN8IfRFUh7UzLG7IdEWlq"
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01METIIJTBO2S0Ri3Noar6qtyIA1Swv8Ds0",
                                                        "name": "Investigate_Enrichment",
                                                        "title": "Investigate_Enrichment",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Investigate_Enrichment",
                                                          "input": {
                                                            "variable_workflow_01KGGGNGTQOJU3ZUBXV6CNhbsvLB8HsNd88": "$global.variable_01MET7PX13X2762mqJPLYBVQCFn31jFhjkk.global.variable_01MET7PX13X2762mqJPLYBVQCFn31jFhjkk$",
                                                            "variable_workflow_01KGGH1TAU9HQ4ZCjJ05xYFodtIZjO9o0K2": "$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$",
                                                            "variable_workflow_01KGGH7TRFPS56yJl1rKcPo0TdSoIGOlBGf": "domain"
                                                          },
                                                          "runtime_user": {
                                                            "target_default": true
                                                          },
                                                          "skip_execution": false,
                                                          "target": {
                                                            "override_workflow_target": true,
                                                            "target_id": "definition_target_01KGG0KMS7DCO4c1U9dH2btJevVFhn73eaX",
                                                            "target_type": "web-service.endpoint"
                                                          },
                                                          "workflow_id": "definition_workflow_01KGGEY4ZKDEV4QRry4LmBMFV8HjjkdKUQY"
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MESVIQ3IDBN05NVMLj8zPXxgEzHfZEcy2",
                                                        "name": "Select from Table",
                                                        "title": "Select from Table Classifier",
                                                        "type": "core.selectfromtable",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "action_timeout": 180,
                                                          "columns": [
                                                            {
                                                              "column_name": "type",
                                                              "column_type": "string"
                                                            },
                                                            {
                                                              "column_name": "value",
                                                              "column_type": "string"
                                                            }
                                                          ],
                                                          "continue_on_failure": false,
                                                          "display_name": "Select from Table Classifier",
                                                          "input_table": "$activity.definition_activity_01METIIJTBO2S0Ri3Noar6qtyIA1Swv8Ds0.output.variable_workflow_01KGJNU5GCI9D1xsasfHtJXto2DnNjcHxUO$",
                                                          "number_of_rows": {
                                                            "all_rows": true,
                                                            "at_most": false
                                                          },
                                                          "persist_output": false,
                                                          "skip_execution": false,
                                                          "sorting": {
                                                            "no_sort": true,
                                                            "sort_by": false
                                                          }
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MEUIJM38D4W4HmdjQALMi1vzMLM1xnAba",
                                                        "name": "Replace String",
                                                        "title": "Replace String Classifier",
                                                        "type": "core.replacestring",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Replace String Classifier",
                                                          "input_string": "$activity.definition_activity_01MESVIQ3IDBN05NVMLj8zPXxgEzHfZEcy2.output.response_body$",
                                                          "replace_list": [
                                                            {
                                                              "replaced_string": "{\"type\":\"",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "\",\"value\":\"",
                                                              "replacement_string": ":"
                                                            },
                                                            {
                                                              "replaced_string": "\"}",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "[",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "]",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": ",",
                                                              "replacement_string": "\\n"
                                                            },
                                                            {
                                                              "replaced_string": "\\\"",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "securityCategories",
                                                              "replacement_string": "Categories:\\n"
                                                            }
                                                          ],
                                                          "skip_execution": false
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MEU4TLI81M95O0XBdI19LWX4FDclxzUh1",
                                                        "name": "Select from Table",
                                                        "title": "Select from Table Whois",
                                                        "type": "core.selectfromtable",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "action_timeout": 180,
                                                          "columns": [
                                                            {
                                                              "column_name": "type",
                                                              "column_type": "string"
                                                            },
                                                            {
                                                              "column_name": "value",
                                                              "column_type": "string"
                                                            }
                                                          ],
                                                          "continue_on_failure": false,
                                                          "display_name": "Select from Table Whois",
                                                          "input_table": "$activity.definition_activity_01METIIJTBO2S0Ri3Noar6qtyIA1Swv8Ds0.output.variable_workflow_01KGKFA29H3IR2kE13QUaH7LqogijhsLRQf$",
                                                          "number_of_rows": {
                                                            "all_rows": true,
                                                            "at_most": false
                                                          },
                                                          "persist_output": false,
                                                          "skip_execution": false,
                                                          "sorting": {
                                                            "no_sort": true,
                                                            "sort_by": false
                                                          }
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MEULEMJZJTP3RUER4WBX70nigLSpnOLKy",
                                                        "name": "Replace String",
                                                        "title": "Replace String whois",
                                                        "type": "core.replacestring",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Replace String whois",
                                                          "input_string": "$activity.definition_activity_01MEU4TLI81M95O0XBdI19LWX4FDclxzUh1.output.response_body$",
                                                          "replace_list": [
                                                            {
                                                              "replaced_string": "{\"type\":\"",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "\",\"value\":\"",
                                                              "replacement_string": ":"
                                                            },
                                                            {
                                                              "replaced_string": "\"}",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "[",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "]",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": ",",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "\\\"",
                                                              "replacement_string": ""
                                                            }
                                                          ],
                                                          "skip_execution": false
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MEU6G9DH2P46LpVzVVG2MzpyEBh8zP2J0",
                                                        "name": "Select from Table",
                                                        "title": "Select from Table PDNS",
                                                        "type": "core.selectfromtable",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "action_timeout": 180,
                                                          "columns": [
                                                            {
                                                              "column_name": "type",
                                                              "column_type": "string"
                                                            },
                                                            {
                                                              "column_name": "value",
                                                              "column_type": "string"
                                                            }
                                                          ],
                                                          "continue_on_failure": false,
                                                          "display_name": "Select from Table PDNS",
                                                          "input_table": "$activity.definition_activity_01METIIJTBO2S0Ri3Noar6qtyIA1Swv8Ds0.output.variable_workflow_01KGJOF3CFMJL3cwoINu8vvFut5cjb6cj0g$",
                                                          "number_of_rows": {
                                                            "all_rows": true,
                                                            "at_most": false
                                                          },
                                                          "persist_output": false,
                                                          "skip_execution": false,
                                                          "sorting": {
                                                            "no_sort": true,
                                                            "sort_by": false
                                                          }
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MEULC5IV9P66n60sq36HnrooSorjFWyku",
                                                        "name": "Replace String",
                                                        "title": "Replace String PDNS",
                                                        "type": "core.replacestring",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Replace String PDNS",
                                                          "input_string": "$activity.definition_activity_01MEU6G9DH2P46LpVzVVG2MzpyEBh8zP2J0.output.response_body$",
                                                          "replace_list": [
                                                            {
                                                              "replaced_string": "{\"type\":\"",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "\",\"value\":\"",
                                                              "replacement_string": ":"
                                                            },
                                                            {
                                                              "replaced_string": "\"}",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "[",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "]",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": ",",
                                                              "replacement_string": "\\n"
                                                            },
                                                            {
                                                              "replaced_string": "\\\"",
                                                              "replacement_string": ""
                                                            }
                                                          ],
                                                          "skip_execution": false
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MEU76NJOL713JV9buFCsHRciXAFZB0RoM",
                                                        "name": "Select from Table",
                                                        "title": "Select from Table Security",
                                                        "type": "core.selectfromtable",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "action_timeout": 180,
                                                          "columns": [
                                                            {
                                                              "column_name": "type",
                                                              "column_type": "string"
                                                            },
                                                            {
                                                              "column_name": "value",
                                                              "column_type": "string"
                                                            }
                                                          ],
                                                          "continue_on_failure": false,
                                                          "display_name": "Select from Table Security",
                                                          "input_table": "$activity.definition_activity_01METIIJTBO2S0Ri3Noar6qtyIA1Swv8Ds0.output.variable_workflow_01KGJNZK08AQI2NiidSc5FxXrAWXcvssCE6$",
                                                          "number_of_rows": {
                                                            "all_rows": true,
                                                            "at_most": false
                                                          },
                                                          "persist_output": false,
                                                          "skip_execution": false,
                                                          "sorting": {
                                                            "no_sort": true,
                                                            "sort_by": false
                                                          }
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MEUL9LCMNI34B12qkD1VvxS1HcZ924kiR",
                                                        "name": "Replace String",
                                                        "title": "Replace String Security",
                                                        "type": "core.replacestring",
                                                        "base_type": "activity",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Replace String Security",
                                                          "input_string": "$activity.definition_activity_01MEU76NJOL713JV9buFCsHRciXAFZB0RoM.output.response_body$",
                                                          "replace_list": [
                                                            {
                                                              "replaced_string": "{\"type\":\"",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "\",\"value\":\"",
                                                              "replacement_string": ":"
                                                            },
                                                            {
                                                              "replaced_string": "\"}",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "[",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": "]",
                                                              "replacement_string": ""
                                                            },
                                                            {
                                                              "replaced_string": ",",
                                                              "replacement_string": "\\n"
                                                            },
                                                            {
                                                              "replaced_string": "\\\"",
                                                              "replacement_string": ""
                                                            }
                                                          ],
                                                          "skip_execution": false
                                                        },
                                                        "object_type": "definition_activity"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "unique_name": "definition_activity_01MFQBG91BFI94hYMGmcXcFS1ONxukJzSf6",
                                            "name": "Group",
                                            "title": "Variables",
                                            "type": "logic.group",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Variables",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "actions": [
                                              {
                                                "unique_name": "definition_activity_01MFQBMGCD0TG3DPtTitAk1MxL8kHvE822x",
                                                "name": "Set Variables",
                                                "title": "incident Title",
                                                "type": "core.set_multiple_variables",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "incident Title",
                                                  "skip_execution": false,
                                                  "variables_to_update": [
                                                    {
                                                      "variable_to_update": "$workflow.definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF.local.variable_workflow_01MFQAVD2KA9R6MKrQc2IzDeG1eD1SwHdjZ$",
                                                      "variable_value_new": "Potentially Compromised Endpoint"
                                                    }
                                                  ]
                                                },
                                                "object_type": "definition_activity"
                                              },
                                              {
                                                "unique_name": "definition_activity_01MFQBOGBPFZN2SHd780MER9dqGMOXEbqFI",
                                                "name": "Set Variables",
                                                "title": "Incident Description",
                                                "type": "core.set_multiple_variables",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Incident Description",
                                                  "skip_execution": false,
                                                  "variables_to_update": [
                                                    {
                                                      "variable_to_update": "$workflow.definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF.local.variable_workflow_01MFQB0TUGPOD79KuwdzUDJLmhwsueL9ybJ$",
                                                      "variable_value_new": "Communication to a domain was preevented by Umbrella for security reasons"
                                                    }
                                                  ]
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          },
                                          {
                                            "unique_name": "definition_activity_01MFP5KB03YF94zWNfhDdxUO9BnzDYIAHD4",
                                            "name": "Parallel Block",
                                            "title": "Parallel Block - Create Cases and Incidents",
                                            "type": "logic.parallel",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Parallel Block - Create Cases and Incidents",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "blocks": [
                                              {
                                                "unique_name": "definition_activity_01MFP5KWWD9VN01LmAlpNsVPcOpH5RIbmtO",
                                                "name": "Parallel Branch",
                                                "title": "Parallel Branch SecureX",
                                                "type": "logic.parallel_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Parallel Branch SecureX",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01MFP480SI8E80K4S4GVwq86oldC7KXmmfE",
                                                    "name": "Group",
                                                    "title": "SecureX",
                                                    "type": "logic.group",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "SecureX",
                                                      "skip_execution": false
                                                    },
                                                    "object_type": "definition_activity",
                                                    "actions": [
                                                      {
                                                        "unique_name": "definition_activity_01MF2UDJ9FG3S1aTJE9aTUAvyNXVYr09W6W",
                                                        "name": "Threat Response v2 - Create Casebook",
                                                        "title": "Threat Response v2 - Create Casebook",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Threat Response v2 - Create Casebook",
                                                          "input": {
                                                            "variable_workflow_01KVOGF4J481T6SCd7uh5fW7n47Q712nleJ": "[{\"type\":\"domain\",\"value\":\"$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$\"}]",
                                                            "variable_workflow_01KVOGF4J4FZC0jmaR42b1FbIzVZA19KbYL": "",
                                                            "variable_workflow_01KVOGF4J4IG81TQKFjqzLlnFJwiiNwXwSq": "$activity.definition_activity_01MDI7UAICV7P6NdagEpDYNUhK64uRb5LAV.output.variable_workflow_01BNOOXA3G6MV1PGAvsfZOKDdMYcE6XS726$",
                                                            "variable_workflow_01KVOGF4J4JL52xC9ZXdjYwHt2SvRYkArli": "$activity.definition_activity_01MDI7YQXLLNS2ez7hnTJ3410CXZrQmTn8r.output.result_string$",
                                                            "variable_workflow_01KVOMXV9ERSV0M9j1WarflgSG8r5SpZ8b5": "Communication to the domain $activity.definition_activity_01MDI7YQXLLNS2ez7hnTJ3410CXZrQmTn8r.output.result_string$ was prevented by Umbrella",
                                                            "variable_workflow_01LFBYQJV9FZA2THdEQrMftLyGiiHP65nUq": "amber"
                                                          },
                                                          "runtime_user": {
                                                            "target_default": true
                                                          },
                                                          "skip_execution": false,
                                                          "target": {
                                                            "override_workflow_target": true,
                                                            "target_id": "definition_target_01M8823MMO4QO73ETHXSQUfobrgRuuHHERk",
                                                            "target_type": "web-service.endpoint"
                                                          },
                                                          "workflow_id": "definition_workflow_01KVOGF574Y291CRwQLNB1TtzEHDNwyUx7O"
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MF2XUZ0T5F46axwPOs5AmIlLGPlHUvgiI",
                                                        "name": "Threat Response v2 - Create Incident",
                                                        "title": "Threat Response v2 - Create Incident",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Threat Response v2 - Create Incident",
                                                          "input": {
                                                            "variable_workflow_01KVVWMAKJ5X54vaAuNkKq259VyiO5JCeuC": "$activity.definition_activity_01MDI7UAICV7P6NdagEpDYNUhK64uRb5LAV.output.variable_workflow_01BNOOXA3G6MV1PGAvsfZOKDdMYcE6XS726$",
                                                            "variable_workflow_01KVVWMAKJ9HX4TuMb2g74UqzpRLRxjwlwm": "$workflow.definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF.local.variable_workflow_01MFQAVD2KA9R6MKrQc2IzDeG1eD1SwHdjZ$",
                                                            "variable_workflow_01KVVWMAKJBSF1Fxv8uLSCRGpOJCxkue4OH": "$workflow.definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF.local.variable_workflow_01MFQB0TUGPOD79KuwdzUDJLmhwsueL9ybJ$\n",
                                                            "variable_workflow_01KWIVDCZ7VJU1t9jPK4nZnnwHqnllu7dJm": "New",
                                                            "variable_workflow_01KWIVQVGZKUC0vUPbm3oCvqsYVV036tieP": "High",
                                                            "variable_workflow_01LFBWLGJNHPS450Wh1dwGf1Xqot6KHUTwY": "amber"
                                                          },
                                                          "runtime_user": {
                                                            "target_default": true
                                                          },
                                                          "skip_execution": false,
                                                          "target": {
                                                            "override_workflow_target": true,
                                                            "target_id": "definition_target_01M8823MMO4QO73ETHXSQUfobrgRuuHHERk",
                                                            "target_type": "web-service.endpoint"
                                                          },
                                                          "workflow_id": "definition_workflow_01KVVWMB2UTRF5uVHVH9DtiT6vgIfnzTdRS"
                                                        },
                                                        "object_type": "definition_activity"
                                                      },
                                                      {
                                                        "unique_name": "definition_activity_01MF30XYKCK9M32T9OtOqGDZ4Jpbc3Stq3E",
                                                        "name": "Threat Response v2 - Create Relationship",
                                                        "title": "Threat Response v2 - Create Relationship",
                                                        "type": "workflow.atomic_workflow",
                                                        "base_type": "subworkflow",
                                                        "properties": {
                                                          "continue_on_failure": false,
                                                          "display_name": "Threat Response v2 - Create Relationship",
                                                          "input": {
                                                            "variable_workflow_01KWID476NLS63mQo7De2Wk9Q1WAJb0dJXe": "$activity.definition_activity_01MDI7UAICV7P6NdagEpDYNUhK64uRb5LAV.output.variable_workflow_01BNOOXA3G6MV1PGAvsfZOKDdMYcE6XS726$",
                                                            "variable_workflow_01KWID476NNBL4xUNZ1ze05KmIr6MTOd2tf": "related-to",
                                                            "variable_workflow_01KWID476NOW27YCzfBvT6jlpfoo4jDNQoS": "relation",
                                                            "variable_workflow_01KWID476NRV53BPxHqiyGzSy3hiS50IIYt": "",
                                                            "variable_workflow_01KWIOPHDZHRM2nxENJ5E3iBUjDizSHzujd": "$activity.definition_activity_01MF2UDJ9FG3S1aTJE9aTUAvyNXVYr09W6W.output.variable_workflow_01KVOGF4J4HBH1AEO1b5YnhSpqUnFihUeXS$",
                                                            "variable_workflow_01KWIP24K2A5P6ag8merXYIrzb5KHnOSzU3": "$activity.definition_activity_01MF2XUZ0T5F46axwPOs5AmIlLGPlHUvgiI.output.variable_workflow_01KVVWMAKJDWL0w7z086xbnRNZMwGcpxweP$",
                                                            "variable_workflow_01LFBZWJ98ZH426APtwKiW7OM9nNQMfT7IA": "amber"
                                                          },
                                                          "runtime_user": {
                                                            "target_default": true
                                                          },
                                                          "skip_execution": false,
                                                          "target": {
                                                            "override_workflow_target": true,
                                                            "target_id": "definition_target_01M8823MMO4QO73ETHXSQUfobrgRuuHHERk",
                                                            "target_type": "web-service.endpoint"
                                                          },
                                                          "workflow_id": "definition_workflow_01KWID47SRHY30TYWU3BQSFODWA7PVO360x"
                                                        },
                                                        "object_type": "definition_activity"
                                                      }
                                                    ]
                                                  }
                                                ]
                                              },
                                              {
                                                "unique_name": "definition_activity_01MFP5KXKJ5HD75kM2yTc9rRhpTdsiVdrZp",
                                                "name": "Parallel Branch",
                                                "title": "Parallel Branch Hive",
                                                "type": "logic.parallel_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Parallel Branch Hive",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01MF9OMHDNHYA7W0UflWvbPlg3ABGmvACVq",
                                                    "name": "Create TheHive Case 🐝",
                                                    "title": "Create TheHive Case 🐝",
                                                    "type": "workflow.sub_workflow",
                                                    "base_type": "subworkflow",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Create TheHive Case 🐝",
                                                      "input": {
                                                        "variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X": "domain",
                                                        "variable_workflow_01INF3UDYNQKX5CelhdUCO2erfy6KZzebOc": "$activity.definition_activity_01MDI7VT0FUPC78oBkEY59mLDDvhZvfbGXC.input.source_array[@].distinctvalue$",
                                                        "variable_workflow_01MFQ5DEZV9720Vm4tPekRNyzzdgFehz5Qg": "$workflow.definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF.local.variable_workflow_01MFQAVD2KA9R6MKrQc2IzDeG1eD1SwHdjZ$",
                                                        "variable_workflow_01MFQ641NZL3L44wKacDII2eUrx3TQopusD": "$workflow.definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF.local.variable_workflow_01MFQB0TUGPOD79KuwdzUDJLmhwsueL9ybJ$"
                                                      },
                                                      "runtime_user": {
                                                        "target_default": true
                                                      },
                                                      "skip_execution": false,
                                                      "target": {
                                                        "override_workflow_target": true,
                                                        "target_id": "definition_target_01INF591NOZWT4Rq1VbQQB6FAncMRfGlDni",
                                                        "target_type": "web-service.endpoint"
                                                      },
                                                      "workflow_id": "definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp"
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              },
                                              {
                                                "unique_name": "definition_activity_01MFP64H4WYY53ocERFXdhyWaZt1tYTX5ol",
                                                "name": "Parallel Branch",
                                                "title": "Parallel Branch Service Now",
                                                "type": "logic.parallel_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Parallel Branch Service Now",
                                                  "skip_execution": true
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01MFREFQ256XL6M5UIvwG2SNt0YtmqYMDTd",
                                                    "name": "Service Now - Create Incident",
                                                    "title": "Service Now - Create Incident",
                                                    "type": "workflow.atomic_workflow",
                                                    "base_type": "subworkflow",
                                                    "properties": {
                                                      "continue_on_failure": false,
                                                      "display_name": "Service Now - Create Incident",
                                                      "input": {
                                                        "variable_workflow_01C0CK2MY2SLG1FXph6ZHp7iHmRw1KvUFlN": "",
                                                        "variable_workflow_01FGYF0DUR8HV2TMpEKctsYjQR4mzjD5OTu": "",
                                                        "variable_workflow_01FGYGCZL5M2E1m1O5tvVVn0DVzVTLwytei": 2,
                                                        "variable_workflow_01FGYGPFJYM4L5aVpzNOhRwMmzKJDofqufe": 2,
                                                        "variable_workflow_01FGYGZ0OYYNM5pWjyyreMjNHDjusjNe8jx": "",
                                                        "variable_workflow_01FGYI8HES41K63G3UzMinBH3iApm37fBGt": "",
                                                        "variable_workflow_01FMQD0HIJIDU5kce0VNx4HQiMYjMfUvBlj": "v2"
                                                      },
                                                      "runtime_user": {
                                                        "target_default": true
                                                      },
                                                      "skip_execution": true,
                                                      "target": {
                                                        "target_type": "web-service.endpoint",
                                                        "use_workflow_target": true
                                                      },
                                                      "workflow_id": "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW"
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              }
                                            ]
                                          },
                                          {
                                            "unique_name": "definition_activity_01MFP7JXIC5IS28FBJ5O3cKfwifZOfVHi27",
                                            "name": "Parallel Block",
                                            "title": "Parallel Block - Notify Update",
                                            "type": "logic.parallel",
                                            "base_type": "activity",
                                            "properties": {
                                              "continue_on_failure": false,
                                              "display_name": "Parallel Block - Notify Update",
                                              "skip_execution": false
                                            },
                                            "object_type": "definition_activity",
                                            "blocks": [
                                              {
                                                "unique_name": "definition_activity_01MFP7KJ15ID32eKid4TtJ1sBgshYNwPqmq",
                                                "name": "Parallel Branch",
                                                "title": "Parallel Branch Cisco Webex",
                                                "type": "logic.parallel_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Parallel Branch Cisco Webex",
                                                  "skip_execution": false
                                                },
                                                "object_type": "definition_activity",
                                                "actions": [
                                                  {
                                                    "unique_name": "definition_activity_01MGJUQBQ2NG325hLracdJwFmG9F0ss6MKr",
                                                    "name": "HTTP Request",
                                                    "title": "Post Adaptive card to webex",
                                                    "type": "web-service.http_request",
                                                    "base_type": "activity",
                                                    "properties": {
                                                      "action_timeout": 180,
                                                      "allow_auto_redirect": true,
                                                      "body": "{\n  \"roomId\": \"$activity.definition_activity_01MDI7IWXKS5U6RtE3TpGxfcvAAyKOyaVEt.output.variable_workflow_01FHSVE2R6ZTQ6L92WEi0kWgR5T8zhMAUzO$\",\n  \"markdown\": \"Details about Domain $activity.definition_activity_01MDI7YQXLLNS2ez7hnTJ3410CXZrQmTn8r.output.result_string$ ].\",\n  \"attachments\": [\n    {\n      \"contentType\": \"application/vnd.microsoft.card.adaptive\",\n      \"content\": {\n        \"$schema\": \"http://adaptivecards.io/schemas/adaptive-card.json\",\n        \"type\": \"AdaptiveCard\",\n        \"version\": \"1.0\",\n        \"body\": [\n        {\n            \"type\": \"ColumnSet\",\n            \"columns\": [\n                {\n                    \"type\": \"Column\",\n                    \"items\": [\n                        {\n                            \"type\": \"Image\",\n                            \"style\": \"Person\",\n                            \"url\": \"https://www.ingramflyhigher.com/campaigns/cisco-umbrella/images/umbrella-small.png\",\n                            \"size\": \"Medium\",\n                            \"height\": \"50px\"\n                        }\n                    ],\n                    \"width\": \"auto\"\n                },\n                {\n                    \"type\": \"Column\",\n                    \"items\": [\n                        {\n                            \"type\": \"TextBlock\",\n                            \"text\": \"Umbrella - SecureX Notification\",\n                            \"weight\": \"Lighter\",\n                            \"color\": \"Accent\"\n                        },\n                        {\n                            \"type\": \"TextBlock\",\n                            \"weight\": \"Bolder\",\n                            \"text\": \"Domain $activity.definition_activity_01MDI7YQXLLNS2ez7hnTJ3410CXZrQmTn8r.output.result_string$- Details\",\n                            \"horizontalAlignment\": \"Left\",\n                            \"wrap\": true,\n                            \"color\": \"Light\",\n                            \"size\": \"Large\",\n                            \"spacing\": \"Small\"\n                        }\n                    ],\n                    \"width\": \"stretch\"\n                }\n            ]\n        },\n        {\n            \"type\": \"ColumnSet\",\n            \"columns\": [\n                {\n                    \"type\": \"Column\",\n                    \"width\": 35,\n                    \"items\": [\n                        {\n                            \"type\": \"TextBlock\",\n                            \"text\": \"Whois\",\n                            \"color\": \"Light\"\n                        },\n                        {\n                            \"type\": \"TextBlock\",\n                            \"text\": \"Judgements\",\n                            \"color\": \"Light\"\n                        },\n                        {\n                            \"type\": \"TextBlock\",\n                            \"color\": \"Light\",\n                            \"text\": \"Targets\"\n                        }\n                    ]\n                },\n                {\n                    \"type\": \"Column\",\n                    \"width\": 65,\n                    \"items\": [\n                        {\n                            \"type\": \"TextBlock\",\n                            \"weight\": \"Bolder\",\n                            \"text\": \"$activity.definition_activity_01MEULEMJZJTP3RUER4WBX70nigLSpnOLKy.output.result_string$ \"\n                        },\n                        {\n                            \"type\": \"TextBlock\",\n                            \"weight\": \"Bolder\",\n                            \"text\": \"a\"\n                        },\n                        {\n                            \"type\": \"TextBlock\",\n                            \"weight\": \"Bolder\",\n                            \"text\": \"$activity.definition_activity_01MFTSV8LXMI70GbA7zeoEVgtAZVW11tP3N.output.variable_workflow_01MD80H8IOH795VaLYdymH1rvCEVy2hGqYc$\"\n                        }\n                    ]\n                }\n            ],\n            \"spacing\": \"Padding\",\n            \"horizontalAlignment\": \"Center\"\n        },\n        {\n            \"type\": \"TextBlock\",\n            \"text\": \"An incident has been raised in SOC tools\",\n            \"wrap\": true\n        }\n    ]\n      }\n    }\n  ]\n}",
                                                      "content_type": "application/json",
                                                      "continue_on_error_status_code": false,
                                                      "continue_on_failure": false,
                                                      "custom_headers": [
                                                        {
                                                          "name": "Authorization",
                                                          "value": "Bearer $global.variable_01KEH4RU5N6VM1dCv2HDrsRXCbj0pv64GI8.global.variable_01KEH4RU5N6VM1dCv2HDrsRXCbj0pv64GI8$"
                                                        }
                                                      ],
                                                      "display_name": "Post Adaptive card to webex",
                                                      "method": "POST",
                                                      "relative_url": "/v1/messages",
                                                      "runtime_user": {
                                                        "override_target_runtime_user": false,
                                                        "target_default": true
                                                      },
                                                      "skip_execution": false,
                                                      "target": {
                                                        "override_workflow_target": true,
                                                        "target_id": "definition_target_01KJANNE7TR2C6ahGVhbhP3X5JvEtPoSLKV"
                                                      }
                                                    },
                                                    "object_type": "definition_activity"
                                                  },
                                                  {
                                                    "unique_name": "definition_activity_01MESTT4MSQ1N6hTMEzFZ5SUzIAew0uoTi1",
                                                    "name": "Webex Teams - Post Message to Room",
                                                    "title": "Webex Teams - Post Message to Room",
                                                    "type": "workflow.atomic_workflow",
                                                    "base_type": "subworkflow",
                                                    "properties": {
                                                      "continue_on_failure": true,
                                                      "display_name": "Webex Teams - Post Message to Room",
                                                      "input": {
                                                        "variable_workflow_01FGYY44G3MZ55amJu9YqgUeKS8GT49bZx3": "$global.variable_01KEH4RU5N6VM1dCv2HDrsRXCbj0pv64GI8.global.variable_01KEH4RU5N6VM1dCv2HDrsRXCbj0pv64GI8$",
                                                        "variable_workflow_01FGYY44G3TK951Crpnd8g2izonyM4bFtpW": "$activity.definition_activity_01MDI7IWXKS5U6RtE3TpGxfcvAAyKOyaVEt.output.variable_workflow_01FHSVE2R6ZTQ6L92WEi0kWgR5T8zhMAUzO$",
                                                        "variable_workflow_01FGYY44G3UPV3heGGc3vXCV47YL5WoI2X6": "",
                                                        "variable_workflow_01FGYZ9BV4QTP19CuMwcW8QywvCP9ymx2BZ": "Domain $activity.definition_activity_01MDI7YQXLLNS2ez7hnTJ3410CXZrQmTn8r.output.result_string$\\n\n$activity.definition_activity_01MEUIJM38D4W4HmdjQALMi1vzMLM1xnAba.output.result_string$\\n\nWhoIs : \\n$activity.definition_activity_01MEULEMJZJTP3RUER4WBX70nigLSpnOLKy.output.result_string$\\n\nSecurity : \\n$activity.definition_activity_01MEUL9LCMNI34B12qkD1VvxS1HcZ924kiR.output.result_string$\\n\n\nAn incident has been created"
                                                      },
                                                      "runtime_user": {
                                                        "target_default": true
                                                      },
                                                      "skip_execution": true,
                                                      "target": {
                                                        "override_workflow_target": true,
                                                        "target_id": "definition_target_01KJANNE7TR2C6ahGVhbhP3X5JvEtPoSLKV",
                                                        "target_type": "web-service.endpoint"
                                                      },
                                                      "workflow_id": "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf"
                                                    },
                                                    "object_type": "definition_activity"
                                                  }
                                                ]
                                              },
                                              {
                                                "unique_name": "definition_activity_01MFP7KJP721X1L5nut1wJvj43RS4fXtxSH",
                                                "name": "Parallel Branch",
                                                "title": "Parallel Branch Microsoft Teams",
                                                "type": "logic.parallel_block",
                                                "base_type": "activity",
                                                "properties": {
                                                  "continue_on_failure": false,
                                                  "display_name": "Parallel Branch Microsoft Teams",
                                                  "skip_execution": true
                                                },
                                                "object_type": "definition_activity"
                                              }
                                            ]
                                          }
                                        ]
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "unique_name": "definition_activity_01MFP8ZE84QOK7XStng6LCfYwzntOFuN1vJ",
                                "name": "Group",
                                "title": "Clear Temp",
                                "type": "logic.group",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Clear Temp",
                                  "skip_execution": false
                                },
                                "object_type": "definition_activity",
                                "actions": [
                                  {
                                    "unique_name": "definition_activity_01MDI7ZS2DBHG4fuF86leMCeS4bkrdKv8Lw",
                                    "name": "Delete from Table",
                                    "title": "Clear temp domain table",
                                    "type": "core.deleterowfromtable",
                                    "base_type": "activity",
                                    "properties": {
                                      "action_timeout": 180,
                                      "continue_on_failure": true,
                                      "display_name": "Clear temp domain table",
                                      "input_table": "$workflow.definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF.local.variable_workflow_01MDI7G9FT39N3o2LGJm6OAmZxsGZCCTOqM$",
                                      "rows": {
                                        "all_rows": true,
                                        "rows_matching_criteria": false
                                      },
                                      "skip_execution": false
                                    },
                                    "object_type": "definition_activity"
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01MFPKM1SDBD170rLjo4tSe3Im9vMYVdSrK",
                        "name": "Group",
                        "title": "Admin",
                        "type": "logic.group",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Admin",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01MDI804H120M30hABQ6n8x4YxD1GCqURBx",
                            "name": "Sleep",
                            "title": "Sleep",
                            "type": "core.sleep",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Sleep",
                              "skip_execution": false,
                              "sleep_interval": 5
                            },
                            "object_type": "definition_activity"
                          },
                          {
                            "unique_name": "definition_activity_01MDI80GCSLK03G5XYOvm7XSXuWRvZ1GuWL",
                            "name": "Set Variables",
                            "title": "Loop counter +1",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": true,
                              "display_name": "Loop counter +1",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$global.variable_01LGYFHE8DD8A7767SRhj0daGxv5R67jPTk.global.variable_01LGYFHE8DD8A7767SRhj0daGxv5R67jPTk$",
                                  "variable_value_new": "$global.variable_01LGYFHE8DD8A7767SRhj0daGxv5R67jPTk.global.variable_01LGYFHE8DD8A7767SRhj0daGxv5R67jPTk$+1"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01MDI80SP4BIR2uRvlnjvCv5L2kWbN4q22Q",
            "name": "Condition Branch",
            "title": "Condition Loop Counter not 500",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$global.variable_01LGYFHE8DD8A7767SRhj0daGxv5R67jPTk.global.variable_01LGYFHE8DD8A7767SRhj0daGxv5R67jPTk$",
                "operator": "ne",
                "right_operand": 500
              },
              "continue_on_failure": false,
              "display_name": "Condition Loop Counter not 500",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01MDI814RUUBB4ZdhS6xvmDud2z2UGnkKbP",
                "name": "Completed",
                "title": "Completed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "succeeded",
                  "continue_on_failure": false,
                  "display_name": "Completed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_01EI33LMFFL7N5eTQLsOOJIrxdlSOHb7r3r"
    ]
  },
  "categories": {
    "category_01EI33LMFFL7N5eTQLsOOJIrxdlSOHb7r3r": {
      "unique_name": "category_01EI33LMFFL7N5eTQLsOOJIrxdlSOHb7r3r",
      "name": "SecureX",
      "title": "SecureX",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    },
    "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m": {
      "unique_name": "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
      "name": "response",
      "title": "response",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    },
    "category_01J34RNXN1I004VFDp1al73guvQFeBwkIyp": {
      "unique_name": "category_01J34RNXN1I004VFDp1al73guvQFeBwkIyp",
      "name": "TheHive",
      "title": "TheHive",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "triggers": {
    "triggerschedule_01MF0POTAJRS93DX5mQlu5KG5TF1TFuvhYC": {
      "workflow_id": "definition_workflow_01MDI7G9NC6JO4hChAqfZ0p6qoF6Z3m7WCF",
      "name": "5mn",
      "title": "",
      "lowercase_name": "schedule.5mn",
      "type": "schedule",
      "base_type": "trigger",
      "ref_id": "schedule_01KGEGA0EY2FG7fu2UWuBgKx04bAOd0Gn1x",
      "version": "",
      "disabled": false,
      "unique_name": "triggerschedule_01MF0POTAJRS93DX5mQlu5KG5TF1TFuvhYC",
      "object_type": "triggerschedule"
    }
  },
  "schedules": {
    "schedule_01KGEGA0EY2FG7fu2UWuBgKx04bAOd0Gn1x": {
      "unique_name": "schedule_01KGEGA0EY2FG7fu2UWuBgKx04bAOd0Gn1x",
      "name": "Umbrella_Alerting AO",
      "type": "basic.schedule",
      "base_type": "schedule",
      "properties": {
        "calendar": "calendar_recurring_1BMfMWvgiDhSjBQ7hTSyvz3NyVZ",
        "timezone": "Etc/GMT+0",
        "starttime": "00:01",
        "interval_hours": 0,
        "interval_minutes": 5,
        "number_of_times": 287,
        "display_name": "Umbrella_Alerting AO",
        "description": ""
      },
      "version": "1.0.0",
      "object_type": "schedule"
    }
  },
  "targets": {
    "definition_target_01INF591NOZWT4Rq1VbQQB6FAncMRfGlDni": {
      "unique_name": "definition_target_01INF591NOZWT4Rq1VbQQB6FAncMRfGlDni",
      "name": "TheHive",
      "title": "TheHive",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "description": "TheHive Instance\n- to sync up the Cases and Observables\n- to start the Analyzers",
        "disable_certificate_validation": true,
        "display_name": "TheHive",
        "host": "ivberlin.hopto.org",
        "ignore_proxy": false,
        "no_runtime_user": true,
        "port": 9000,
        "protocol": "http"
      }
    },
    "definition_target_01JLRTQCEHBA93OQhYXQCrV9TYW4Lmy1oS3": {
      "unique_name": "definition_target_01JLRTQCEHBA93OQhYXQCrV9TYW4Lmy1oS3",
      "name": "Cisco Umbrella Reporting API_v1",
      "title": "Cisco Umbrella Reporting API_v1",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "default_runtime_user_id": "definition_runtime_user_01JLRA8VF1WE33hotP5HWX5MmH6STnqkdoH",
        "disable_certificate_validation": false,
        "display_name": "Cisco Umbrella Reporting API_v1",
        "host": "reports.api.umbrella.com",
        "ignore_proxy": false,
        "no_runtime_user": false,
        "port": 443,
        "protocol": "https"
      }
    },
    "definition_target_01KJANNE7TR2C6ahGVhbhP3X5JvEtPoSLKV": {
      "unique_name": "definition_target_01KJANNE7TR2C6ahGVhbhP3X5JvEtPoSLKV",
      "name": "Cisco Teams API",
      "title": "Cisco Teams API",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "disable_certificate_validation": false,
        "display_name": "Cisco Teams API",
        "host": "webexapis.com",
        "ignore_proxy": false,
        "no_runtime_user": true,
        "protocol": "https"
      }
    },
    "definition_target_01M8822GXMSX91tiv83gbLmYF1TBH65ZP8l": {
      "unique_name": "definition_target_01M8822GXMSX91tiv83gbLmYF1TBH65ZP8l",
      "name": "CTR_API",
      "title": "CTR API Target",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "description": "Target used to invoke iroh endpoints",
        "disable_certificate_validation": false,
        "display_name": "CTR_API",
        "host": "visibility.amp.cisco.com",
        "no_runtime_user": true,
        "path": "/iroh",
        "protocol": "https"
      }
    },
    "definition_target_01M8823MMO4QO73ETHXSQUfobrgRuuHHERk": {
      "unique_name": "definition_target_01M8823MMO4QO73ETHXSQUfobrgRuuHHERk",
      "name": "Private_CTIA_Target",
      "title": "Private_CTIA_Target",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "description": "Private_CTIA_Target",
        "disable_certificate_validation": false,
        "display_name": "Private_CTIA_Target",
        "host": "private.intel.amp.cisco.com",
        "no_runtime_user": true,
        "protocol": "https"
      }
    },
    "definition_target_01MET9C3C0W320lrxwOCzcG7Yw1Rg3zMBSj": {
      "unique_name": "definition_target_01MET9C3C0W320lrxwOCzcG7Yw1Rg3zMBSj",
      "name": "Investigate",
      "title": "Investigate",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "disable_certificate_validation": false,
        "display_name": "Investigate",
        "host": "investigate.api.umbrella.com",
        "ignore_proxy": false,
        "no_runtime_user": true,
        "protocol": "https"
      }
    }
  },
  "runtime_users": {
    "definition_runtime_user_01JLRA8VF1WE33hotP5HWX5MmH6STnqkdoH": {
      "unique_name": "definition_runtime_user_01JLRA8VF1WE33hotP5HWX5MmH6STnqkdoH",
      "name": "Cisco Umbrella Reporting API",
      "title": "Cisco Umbrella Reporting API",
      "type": "runtime_user.web-service_basic_credentials",
      "base_type": "runtime_user",
      "object_type": "definition_runtime_user",
      "properties": {
        "auth_option": "*****",
        "basic_password": "*****",
        "basic_username": "*****",
        "description": "Enter your Cisco Umbrella Reporting API (https://docs.umbrella.com/umbrella-api/docs/reporting-api-authentication) and set auth to Basic",
        "display_name": "Cisco Umbrella Reporting API"
      }
    }
  },
  "variables": {
    "variable_01JFSSZPEIFML6kKBvOTdiRsSYJveW6WDCw": {
      "unique_name": "variable_01JFSSZPEIFML6kKBvOTdiRsSYJveW6WDCw",
      "properties": {
        "value": "*****",
        "scope": "global",
        "name": "TheHive___BearerToken",
        "type": "datatype.secure_string",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_01KEH4RU5N6VM1dCv2HDrsRXCbj0pv64GI8": {
      "unique_name": "variable_01KEH4RU5N6VM1dCv2HDrsRXCbj0pv64GI8",
      "properties": {
        "value": "*****",
        "scope": "global",
        "name": "Cisco Teams BOT Token",
        "type": "datatype.secure_string",
        "description": "Enter here your Teams Bot token (https://developer.webex.com/docs/bots)- Remember to create a room named Alerting in Teams and add your bot as member",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_01LGYFHE8DD8A7767SRhj0daGxv5R67jPTk": {
      "unique_name": "variable_01LGYFHE8DD8A7767SRhj0daGxv5R67jPTk",
      "properties": {
        "value": 105,
        "scope": "global",
        "name": "Loop Counter  Umbrella Alerting AO",
        "type": "datatype.integer",
        "description": "Should be set to 500 at first run of the AO",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_01LL3TQGT3RD9584LsDd2gEmZ7qGBN1OoYt": {
      "unique_name": "variable_01LL3TQGT3RD9584LsDd2gEmZ7qGBN1OoYt",
      "properties": {
        "value": "*****",
        "scope": "global",
        "name": "Umbrella_Org_ID",
        "type": "datatype.secure_string",
        "description": "Enter here your Umbrella Org ID",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_01MET7PX13X2762mqJPLYBVQCFn31jFhjkk": {
      "unique_name": "variable_01MET7PX13X2762mqJPLYBVQCFn31jFhjkk",
      "properties": {
        "value": "*****",
        "scope": "global",
        "name": "Investigate Token",
        "type": "datatype.secure_string",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    },
    "variable_01MGJAP9XYQ682iEgn3j9lPz7JaWeisRUXY": {
      "unique_name": "variable_01MGJAP9XYQ682iEgn3j9lPz7JaWeisRUXY",
      "schema_id": "tabletype_01EGEGSGVS20N13S1KPEz8fOy2ANAhTiYpj",
      "properties": {
        "value": [
          {
            "column_data": {
              "distinctvalue": "domain"
            }
          },
          {
            "column_data": {
              "distinctvalue": "retdemos.com"
            }
          }
        ],
        "scope": "global",
        "name": "Umbrella - alerting - domain list",
        "type": "datatype.table",
        "is_required": false,
        "is_invisible": false
      },
      "object_type": "variable"
    }
  },
  "table_types": {
    "tabletype_01EGEGSGVS20N13S1KPEz8fOy2ANAhTiYpj": {
      "unique_name": "tabletype_01EGEGSGVS20N13S1KPEz8fOy2ANAhTiYpj",
      "data_type": "datatype.tabletype",
      "display_name": "distinct_value_table",
      "columns": [
        {
          "name": "distinctvalue",
          "title": "distinctvalue",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    },
    "tabletype_01J33VB182X1Z5J5okMTLiOopr2s6GLBkJk": {
      "unique_name": "tabletype_01J33VB182X1Z5J5okMTLiOopr2s6GLBkJk",
      "data_type": "datatype.tabletype",
      "display_name": "Cortex_Analyzers",
      "columns": [
        {
          "name": "AnalyzerID",
          "title": "AnalyzerID",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  },
  "subworkflows": [
    {
      "workflow": {
        "unique_name": "definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp",
        "name": "Investigate - Create TheHive Case 🐝",
        "title": "Investigate - Create TheHive Case 🐝",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "observable_type",
              "type": "datatype.string",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "TheHiveCase_ID",
              "type": "datatype.string",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01J4MKA0Y35CW1SmHxnbKprIkfRDotRn3vZ",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "empty",
              "scope": "input",
              "name": "title",
              "type": "datatype.string",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01MFQ5DEZV9720Vm4tPekRNyzzdgFehz5Qg",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "empty",
              "scope": "input",
              "name": "description",
              "type": "datatype.string",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01MFQ641NZL3L44wKacDII2eUrx3TQopusD",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "local",
              "name": "observable_type_TheHive",
              "type": "datatype.string",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01IQ3YO9HMAZK4kQOCSe5PiNaNJ6kIKILY3",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "observable_value",
              "type": "datatype.string",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_01INF3UDYNQKX5CelhdUCO2erfy6KZzebOc",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "description": "Takes in any observable and will create a new case TheHive\n- adds the observable to the Case\n- starts every applicable Anaylzer\n",
          "display_name": "Investigate - Create TheHive Case 🐝",
          "runtime_user": {
            "override_target_runtime_user": false,
            "specify_on_workflow_start": false,
            "target_default": true
          },
          "target": {
            "target_type": "web-service.endpoint",
            "specify_on_workflow_start": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_01INFQ59QUOMN1xHh5e7rzC946uTwZXN86c",
            "name": "Condition Block",
            "title": "Which observable type was provided?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Which observable type was provided?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01INFQ5EHU6H36fItptxaewHddlvhzXmplV",
                "name": "Condition Branch",
                "title": "IP Address",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X$",
                    "operator": "eqi",
                    "right_operand": "IP"
                  },
                  "continue_on_failure": false,
                  "display_name": "IP Address",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01IQ3YW4WUH7I7Es27al4fBMMOPdxk7nGm8",
                    "name": "Set Variables",
                    "title": "Set Local Variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Local Variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.local.variable_workflow_01IQ3YO9HMAZK4kQOCSe5PiNaNJ6kIKILY3$",
                          "variable_value_new": "ip"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01INFQ5FGLMN10soWaGlPCEXFWbd90eVIuA",
                "name": "Condition Branch",
                "title": "Hostname",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X$",
                    "operator": "eqi",
                    "right_operand": "hostname"
                  },
                  "continue_on_failure": false,
                  "display_name": "Hostname",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01IQ3ZJN8H6ST2do1tByuutzWZvcw2JjN6d",
                    "name": "Set Variables",
                    "title": "Set Local Variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Local Variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.local.variable_workflow_01IQ3YO9HMAZK4kQOCSe5PiNaNJ6kIKILY3$",
                          "variable_value_new": "hostname"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01J5FT59C0VN22zUZwZr6wEV3reUQws7LMH",
                "name": "Condition Branch",
                "title": "domain",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X$",
                    "operator": "eqi",
                    "right_operand": "domain"
                  },
                  "continue_on_failure": false,
                  "display_name": "domain",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01J5FT5AW6WO93MXE6rgNnfOhQ8xb5YMnvG",
                    "name": "Set Variables",
                    "title": "Set Local Variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Local Variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.local.variable_workflow_01IQ3YO9HMAZK4kQOCSe5PiNaNJ6kIKILY3$",
                          "variable_value_new": "domain"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01INFQMGCRBPW0uPxbGjurNfZP3uXeQRoPf",
                "name": "Condition Branch",
                "title": "AMP GUID",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X$",
                    "operator": "eqi",
                    "right_operand": "amp_computer_guid"
                  },
                  "continue_on_failure": false,
                  "display_name": "AMP GUID",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01IQ3ZW196QYG52YfyB8ZdicFKvNNpJeDg4",
                    "name": "Set Variables",
                    "title": "Set Local Variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Local Variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.local.variable_workflow_01IQ3YO9HMAZK4kQOCSe5PiNaNJ6kIKILY3$",
                          "variable_value_new": "other"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01INFR0IHNYY10r5m2DMeXXu3J1bpMXXug3",
                "name": "Condition Branch",
                "title": "URL",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X$",
                    "operator": "eqi",
                    "right_operand": "url"
                  },
                  "continue_on_failure": false,
                  "display_name": "URL",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01IQ400569VHG5wVshzS3S4nlFqyMqt9y9Q",
                    "name": "Set Variables",
                    "title": "Set Local Variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Local Variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.local.variable_workflow_01IQ3YO9HMAZK4kQOCSe5PiNaNJ6kIKILY3$",
                          "variable_value_new": "url"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01IQ409IZXWTA525pGNUHBvDT4rz4pcLASk",
                "name": "Condition Branch",
                "title": "SHA256",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X$",
                    "operator": "eqi",
                    "right_operand": "sha256"
                  },
                  "continue_on_failure": false,
                  "display_name": "SHA256",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01IQ409KFV7ES5Q8aCtChl0prinA7IPHB8r",
                    "name": "Set Variables",
                    "title": "Set Local Variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Local Variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.local.variable_workflow_01IQ3YO9HMAZK4kQOCSe5PiNaNJ6kIKILY3$",
                          "variable_value_new": "hash"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01INFSCHU6FXG5IgtywCGRm03MNPkyuI7wO",
                "name": "Condition Branch",
                "title": "Something else",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": {
                      "left_operand": {
                        "left_operand": {
                          "left_operand": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X$",
                          "operator": "ne",
                          "right_operand": "url"
                        },
                        "operator": "or",
                        "right_operand": {
                          "left_operand": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X$",
                          "operator": "ne",
                          "right_operand": "ip"
                        }
                      },
                      "operator": "or",
                      "right_operand": {
                        "left_operand": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X$",
                        "operator": "ne",
                        "right_operand": "hostname"
                      }
                    },
                    "operator": "or",
                    "right_operand": {
                      "left_operand": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X$",
                      "operator": "ne",
                      "right_operand": "amp_computer_guid"
                    }
                  },
                  "continue_on_failure": false,
                  "display_name": "Something else",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01INFUYXT3IQY2jTzciTsmhIEZMmnECJkcG",
                    "name": "Completed",
                    "title": "Unsupported observable",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "failed-completed",
                      "continue_on_failure": false,
                      "display_name": "Unsupported observable",
                      "result_message": "This workflow does not support the observable type $workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3OU4OTOI4ZvxyaXshtPDaMvfXnoT6X$",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01MFQ716QV25D6SByUSDEHIA1S5mgbUQpyT",
            "name": "Parallel Block",
            "title": "Parallel Block",
            "type": "logic.parallel",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Parallel Block",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01MFQ71SBHE2T3PKNDf8OlohuhJLIJDY1Y4",
                "name": "Parallel Branch",
                "title": "Parallel Branch title",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Parallel Branch title",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01MFQ755XF2J14k6o1dcJsf2lKEA3jDY4WB",
                    "name": "Condition Block",
                    "title": "Condition Block",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Condition Block",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01MFQ75H3955H7UFjPRQG3BL4HJ276b4v92",
                        "name": "Condition Branch",
                        "title": "Condition Branch",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01MFQ5DEZV9720Vm4tPekRNyzzdgFehz5Qg$",
                            "operator": "eq",
                            "right_operand": "empty"
                          },
                          "continue_on_failure": false,
                          "display_name": "Condition Branch",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01MFQ8MIZNMPQ05GBf8EESgW1F7uKwl5ddN",
                            "name": "Set Variables",
                            "title": "Set Variables",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Set Variables",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01MFQ5DEZV9720Vm4tPekRNyzzdgFehz5Qg$",
                                  "variable_value_new": "Casebook for $workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3UDYNQKX5CelhdUCO2erfy6KZzebOc$ - Created by SecureX Orchestration"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01MFQ71SYDAZR4I1vz0O012GAssqZYso9Bg",
                "name": "Parallel Branch",
                "title": "Parallel Branch description",
                "type": "logic.parallel_block",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Parallel Branch description",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01MFQ87MLMTP73WQAp6a7hvgqIGnhkn5dno",
                    "name": "Condition Block",
                    "title": "Condition Block",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Condition Block",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01MFQ87Y0QW670bZ63Bwvqc0u6Bwxo7kbUx",
                        "name": "Condition Branch",
                        "title": "Condition Branch",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01MFQ641NZL3L44wKacDII2eUrx3TQopusD$",
                            "operator": "eq",
                            "right_operand": "empty"
                          },
                          "continue_on_failure": false,
                          "display_name": "Condition Branch",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01MFQ8OK9FNI27DA6TeCuQEmzjglodH6Sau",
                            "name": "Set Variables",
                            "title": "Set Variables",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Set Variables",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01MFQ641NZL3L44wKacDII2eUrx3TQopusD$",
                                  "variable_value_new": "This case has been created by Created by SecureX Orchestration and is in sync state to the referenced Casebook Case!"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_01INF2F30DIH22RGQ45MxWyKYhtD8Pi6l0H",
            "name": "HTTP Request",
            "title": "Create TheHive Case",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "body": "{\n  \"title\": \"$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01MFQ5DEZV9720Vm4tPekRNyzzdgFehz5Qg$\",\n  \"description\": \"$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01MFQ641NZL3L44wKacDII2eUrx3TQopusD$\"\n}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $global.variable_01JFSSZPEIFML6kKBvOTdiRsSYJveW6WDCw.global.variable_01JFSSZPEIFML6kKBvOTdiRsSYJveW6WDCw$"
                }
              ],
              "display_name": "Create TheHive Case",
              "method": "POST",
              "relative_url": "/api/case",
              "runtime_user": {
                "override_target_runtime_user": false,
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target": true,
                "target_id": "definition_target_01INF591NOZWT4Rq1VbQQB6FAncMRfGlDni"
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01ING6REUYR9M1nfawRVEDgj92Fcvn8cawN",
            "name": "JSONPath Query",
            "title": "Get CaseID",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Get CaseID",
              "input_json": "$activity.definition_activity_01INF2F30DIH22RGQ45MxWyKYhtD8Pi6l0H.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.id",
                  "jsonpath_query_name": "id",
                  "jsonpath_query_type": "integer"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01IQ135R1KP142974FPEfqdsb1fXGN2L7iO",
            "name": "HTTP Request",
            "title": "Add Observables ",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "body": "{\n  \"dataType\": \"$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.local.variable_workflow_01IQ3YO9HMAZK4kQOCSe5PiNaNJ6kIKILY3$\",\n  \"data\": \"$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.input.variable_workflow_01INF3UDYNQKX5CelhdUCO2erfy6KZzebOc$\"\n}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $global.variable_01JFSSZPEIFML6kKBvOTdiRsSYJveW6WDCw.global.variable_01JFSSZPEIFML6kKBvOTdiRsSYJveW6WDCw$"
                }
              ],
              "description": "Adding the Observable to the created Case",
              "display_name": "Add Observables ",
              "method": "POST",
              "relative_url": "/api/case/$activity.definition_activity_01ING6REUYR9M1nfawRVEDgj92Fcvn8cawN.output.jsonpath_queries.id$/artifact",
              "runtime_user": {
                "override_target_runtime_user": false,
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target": true,
                "target_id": "definition_target_01INF591NOZWT4Rq1VbQQB6FAncMRfGlDni"
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01IQ3LXOVFDF17X810RX7SUFhI3RyJ76HVQ",
            "name": "JSONPath Query",
            "title": "Get ObservableID",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "description": "in order to run the Analyzer we need to determine the Observable ID",
              "display_name": "Get ObservableID",
              "input_json": "$activity.definition_activity_01IQ135R1KP142974FPEfqdsb1fXGN2L7iO.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$..id",
                  "jsonpath_query_name": "id",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01J34VAMM2I785IcQ8BJ2mfnYBKjdWEjfT9",
            "name": "Group",
            "title": "Get Cortex Analyzers by Observable Typ 🌀",
            "type": "logic.group",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Get Cortex Analyzers by Observable Typ 🌀",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_01J34VT1EK01M7h3ex9iZ70D95WMGRXjafW",
                "name": "Get Cortex Analyzers by ObservableType 🧠",
                "title": "Get Cortex Analyzers by ObservableType 🧠",
                "type": "workflow.sub_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Get Cortex Analyzers by ObservableType 🧠",
                  "input": {
                    "variable_workflow_01J2U039OKFIL283FQRQSuug5Z4fvgVmhwu": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.local.variable_workflow_01IQ3YO9HMAZK4kQOCSe5PiNaNJ6kIKILY3$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "no_target": true
                  },
                  "workflow_id": "definition_workflow_01J2U039YMT7908eKHySeUBlY5nQygMaFNl"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01J401W3TJS5S5Iutn9qAaHbuTdPtAM3LL6",
                "name": "Condition Block",
                "title": "Condition Block",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Condition Block",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01J401W9SVZCI3Ikx5aWX2GA21xuCDt6ILx",
                    "name": "Condition Branch",
                    "title": "Condition Branch",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01J34VT1EK01M7h3ex9iZ70D95WMGRXjafW.output.succeeded$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Condition Branch",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01J3I9SRR4E801yuLUUdjvqF4Pu1jbWqepR",
                        "name": "Group",
                        "title": "Iterate through Analyzers",
                        "type": "logic.group",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Iterate through Analyzers",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01J3I9RD07TOP3WanRMYU7QeRkww9fyXqgk",
                            "name": "For Each",
                            "title": "For Each",
                            "type": "logic.for_each",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "For Each",
                              "skip_execution": false,
                              "source_array": "$activity.definition_activity_01J34VT1EK01M7h3ex9iZ70D95WMGRXjafW.output.variable_workflow_01J33VIXH6F0O4d7b9GisqtBwl120cot6TE$"
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01J2TO5Q2P2ZJ5rF862v1FcTD9Lgeckmyf2",
                                "name": "HTTP Request",
                                "title": "Run ThreatResponse Analyzer",
                                "type": "web-service.http_request",
                                "base_type": "activity",
                                "properties": {
                                  "action_timeout": 180,
                                  "allow_auto_redirect": true,
                                  "body": "{\n  \"cortexId\": \"Cortex\",\n  \"artifactId\": \"$activity.definition_activity_01IQ3LXOVFDF17X810RX7SUFhI3RyJ76HVQ.output.jsonpath_queries.id$\",\n  \"analyzerId\": \"$activity.definition_activity_01J3I9RD07TOP3WanRMYU7QeRkww9fyXqgk.input.source_array[@].AnalyzerID$\"\n}",
                                  "content_type": "application/json",
                                  "continue_on_error_status_code": false,
                                  "continue_on_failure": true,
                                  "custom_headers": [
                                    {
                                      "name": "Authorization",
                                      "value": "Bearer $global.variable_01JFSSZPEIFML6kKBvOTdiRsSYJveW6WDCw.global.variable_01JFSSZPEIFML6kKBvOTdiRsSYJveW6WDCw$"
                                    }
                                  ],
                                  "description": "start to run the Analyzer in TheHive",
                                  "display_name": "Run ThreatResponse Analyzer",
                                  "method": "POST",
                                  "relative_url": "/api/connector/cortex/job",
                                  "runtime_user": {
                                    "override_target_runtime_user": false,
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "override_workflow_target": true,
                                    "target_id": "definition_target_01INF591NOZWT4Rq1VbQQB6FAncMRfGlDni"
                                  }
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01J4MKVVQY6SL6YWPw48A6s9PBUHBLyMWs3",
                            "name": "Set Variables",
                            "title": "Update output var with TheHive Case ID",
                            "type": "core.set_multiple_variables",
                            "base_type": "activity",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "Update output var with TheHive Case ID",
                              "skip_execution": false,
                              "variables_to_update": [
                                {
                                  "variable_to_update": "$workflow.definition_workflow_01INF2B36534M2KOKun2vN3oxTwawCMUSBp.output.variable_workflow_01J4MKA0Y35CW1SmHxnbKprIkfRDotRn3vZ$",
                                  "variable_value_new": "$activity.definition_activity_01ING6REUYR9M1nfawRVEDgj92Fcvn8cawN.output.jsonpath_queries.id$"
                                }
                              ]
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01J401WAUVJDP0rPyUwcWaJ29FYhvaLgcsj",
                    "name": "Condition Branch",
                    "title": "Condition Branch",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01J34VT1EK01M7h3ex9iZ70D95WMGRXjafW.output.succeeded$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "Condition Branch",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01J40378U6LAH4qmGc0W8141AaPKFvFOIFn",
                        "name": "Completed",
                        "title": "Completed",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "succeeded",
                          "continue_on_failure": false,
                          "description": "Failed, quit run...",
                          "display_name": "Completed",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ],
        "categories": [
          "category_01EI33LMFFL7N5eTQLsOOJIrxdlSOHb7r3r",
          "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m"
        ]
      },
      "subworkflows": [
        {
          "workflow": {
            "unique_name": "definition_workflow_01J2U039YMT7908eKHySeUBlY5nQygMaFNl",
            "name": "Get Cortex Analyzers by ObservableType 🧠",
            "title": "Get Cortex Analyzers by ObservableType 🧠",
            "type": "generic.workflow",
            "base_type": "workflow",
            "variables": [
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "local",
                  "name": "observable_type_TheHive",
                  "type": "datatype.string",
                  "is_required": false,
                  "is_invisible": false
                },
                "unique_name": "variable_workflow_01J34S32DNDD97XUaNIW69RFKqWkszdG6lv",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "input",
                  "name": "observable_type",
                  "type": "datatype.string",
                  "is_required": false,
                  "is_invisible": false
                },
                "unique_name": "variable_workflow_01J2U039OKFIL283FQRQSuug5Z4fvgVmhwu",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "tabletype_01J33VB182X1Z5J5okMTLiOopr2s6GLBkJk",
                "properties": {
                  "scope": "output",
                  "name": "output_AnalyzerTable",
                  "type": "datatype.table",
                  "is_required": false,
                  "is_invisible": false
                },
                "unique_name": "variable_workflow_01J33VIXH6F0O4d7b9GisqtBwl120cot6TE",
                "object_type": "variable_workflow"
              }
            ],
            "properties": {
              "atomic": {
                "is_atomic": false
              },
              "delete_workflow_instance": false,
              "description": "possible ObservableType's are defined in TheHive!!",
              "display_name": "Get Cortex Analyzers by ObservableType 🧠",
              "runtime_user": {
                "override_target_runtime_user": false,
                "specify_on_workflow_start": false,
                "target_default": true
              },
              "target": {
                "execute_on_target_group": false,
                "execute_on_workflow_target": false,
                "no_target": true,
                "specify_on_workflow_start": false
              }
            },
            "object_type": "definition_workflow",
            "actions": [
              {
                "unique_name": "definition_activity_01J2U067K79NW28wIV39uIJ1cAlHnmhuVDX",
                "name": "HTTP Request",
                "title": "List analyzers for OBSERVABLE TYPE",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": false,
                  "custom_headers": [
                    {
                      "name": "Authorization",
                      "value": "Bearer $global.variable_01JFSSZPEIFML6kKBvOTdiRsSYJveW6WDCw.global.variable_01JFSSZPEIFML6kKBvOTdiRsSYJveW6WDCw$"
                    }
                  ],
                  "description": "List analyzers matching the dataType\n",
                  "display_name": "List analyzers for OBSERVABLE TYPE",
                  "method": "GET",
                  "relative_url": "/api/connector/cortex/analyzer/type/$workflow.definition_workflow_01J2U039YMT7908eKHySeUBlY5nQygMaFNl.input.variable_workflow_01J2U039OKFIL283FQRQSuug5Z4fvgVmhwu$",
                  "runtime_user": {
                    "override_target_runtime_user": false,
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "definition_target_01INF591NOZWT4Rq1VbQQB6FAncMRfGlDni"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01J2U06E88GE17TUJXAp5Amm7hCKBdKnJhk",
                "name": "JSONPath Query",
                "title": "Get Analyzer IDs",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Get Analyzer IDs",
                  "input_json": "$activity.definition_activity_01J2U067K79NW28wIV39uIJ1cAlHnmhuVDX.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$..id",
                      "jsonpath_query_name": "id",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01J34D5IL8UI557sCbm7SQLPjqFUNSR0kzp",
                "name": "Execute Python Script",
                "title": "Sanitize and Convert List",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Sanitize and Convert List",
                  "script": "list_Analyzers = $activity.definition_activity_01J2U06E88GE17TUJXAp5Amm7hCKBdKnJhk.output.jsonpath_queries.id$\nstring_Analyzers = str(list_Analyzers).strip('[]')\nsanitized_Analyzers = string_Analyzers.replace(\" \", \"\")\nresult = sanitized_Analyzers.replace(\"'\",\"\")",
                  "script_queries": [
                    {
                      "script_query": "result",
                      "script_query_name": "CortexAnalyzers",
                      "script_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01J33PNH8M6F41dhhZh0MDxYxgp9FCv4iMX",
                "name": "Group",
                "title": "Iterate through Analyzers",
                "type": "logic.group",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Iterate through Analyzers",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01J33QT8FOCLZ0qMrRSB4M6XEPLlWod7ybY",
                    "name": "Split String",
                    "title": "Split String",
                    "type": "core.splitstring",
                    "base_type": "activity",
                    "properties": {
                      "boundaries": [
                        {
                          "boundary": ","
                        }
                      ],
                      "continue_on_failure": false,
                      "display_name": "Split String",
                      "input_string": "$activity.definition_activity_01J34D5IL8UI557sCbm7SQLPjqFUNSR0kzp.output.script_queries.CortexAnalyzers$",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01J33QVT6TG180fdzOuS3qJhPYDEsFN96aF",
                    "name": "For Each",
                    "title": "For Each",
                    "type": "logic.for_each",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "For Each",
                      "skip_execution": false,
                      "source_array": "$activity.definition_activity_01J33QT8FOCLZ0qMrRSB4M6XEPLlWod7ybY.output.parts$"
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01J33VXWFRLY45TXt8AMCUgMvAnfGV717Xd",
                        "name": "Add Row to Table",
                        "title": "Add Value to Output",
                        "type": "core.addrowtotable",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Add Value to Output",
                          "input_table": "$workflow.definition_workflow_01J2U039YMT7908eKHySeUBlY5nQygMaFNl.output.variable_workflow_01J33VIXH6F0O4d7b9GisqtBwl120cot6TE$",
                          "row": [
                            {
                              "key": "AnalyzerID",
                              "type": "string",
                              "value": "$activity.definition_activity_01J33QVT6TG180fdzOuS3qJhPYDEsFN96aF.input.source_array[@]$"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              }
            ],
            "categories": [
              "category_01J34RNXN1I004VFDp1al73guvQFeBwkIyp"
            ]
          }
        }
      ]
    }
  ],
  "atomic_workflows": [
    "definition_workflow_01LFCW7C2Q1BU6Szjo7JqBWHWPmevmW7uIn",
    "definition_workflow_01MD80H8PYWKP3F28UqWl0nlZ02R0hFCsrX",
    "definition_workflow_01KGGEY4ZKDEV4QRry4LmBMFV8HjjkdKUQY",
    "definition_workflow_01C0BYD0GI1KZ0mxScCSxVrfX70zrUdqLlW",
    "definition_workflow_01G5O02N3T9NE0uN8IfRFUh7UzLG7IdEWlq",
    "definition_workflow_01JQVN9SHDS7U0aI6ARfYbDceWnEXWS9ExB",
    "definition_workflow_01KWID47SRHY30TYWU3BQSFODWA7PVO360x",
    "definition_workflow_01JSC422Z7Y6P7j77mRKAODnr3h9IdWAMUg",
    "definition_workflow_01FHMU6SD5XPL6eRW4zFXqkA1w8jWiQCIBU",
    "definition_workflow_01KVOGF574Y291CRwQLNB1TtzEHDNwyUx7O",
    "definition_workflow_01FGYY44YU521254ygN3Le0In0kEHpiPNpf",
    "definition_workflow_01KVVWMB2UTRF5uVHVH9DtiT6vgIfnzTdRS",
    "definition_workflow_01779LB6MV0P02kvka9TGV5cEam84NrCTy4",
    "definition_workflow_01JQV4CNFF20759mppNEVKw4P4bSRKDXhuC"
  ]
}